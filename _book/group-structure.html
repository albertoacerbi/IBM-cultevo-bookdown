<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Group structured populations and migration | Individual-based models of cultural evolution</title>
  <meta name="description" content="A minimal working structure for the book" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Group structured populations and migration | Individual-based models of cultural evolution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A minimal working structure for the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Group structured populations and migration | Individual-based models of cultural evolution" />
  
  <meta name="twitter:description" content="A minimal working structure for the book" />
  

<meta name="author" content="Alberto Acerbi" />
<meta name="author" content="Alex Mesoudi" />
<meta name="author" content="Marco Smolla" />


<meta name="date" content="2020-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="social-network-structure.html"/>
<link rel="next" href="reproduction-and-transformation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Individual-based models of cultural evolution</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Basics</b></span><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#initialising-the-simulation"><i class="fa fa-check"></i><b>0.1</b> Initialising the simulation</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#execute-generation-turn-over-many-times"><i class="fa fa-check"></i><b>0.2</b> Execute generation turn-over many times</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#plotting-the-model-results"><i class="fa fa-check"></i><b>0.3</b> Plotting the model results</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#write-a-function-to-wrap-the-model-code"><i class="fa fa-check"></i><b>0.4</b> Write a function to wrap the model code</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#run-several-independent-simulations-and-plot-their-results"><i class="fa fa-check"></i><b>0.5</b> Run several independent simulations and plot their results</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#varying-initial-conditions"><i class="fa fa-check"></i><b>0.6</b> Varying initial conditions</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#summary-of-the-model"><i class="fa fa-check"></i><b>0.7</b> Summary of the model</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#analytical-appendix"><i class="fa fa-check"></i><b>0.8</b> Analytical appendix</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#further-reading"><i class="fa fa-check"></i><b>0.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html"><i class="fa fa-check"></i><b>1</b> Unbiased and biased mutation</a><ul>
<li class="chapter" data-level="1.1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#unbiased-mutation"><i class="fa fa-check"></i><b>1.1</b> Unbiased mutation</a></li>
<li class="chapter" data-level="1.2" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#biased-mutation"><i class="fa fa-check"></i><b>1.2</b> Biased mutation</a></li>
<li class="chapter" data-level="1.3" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#summary-of-the-model-1"><i class="fa fa-check"></i><b>1.3</b> Summary of the model</a></li>
<li class="chapter" data-level="1.4" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#analytical-appendix-1"><i class="fa fa-check"></i><b>1.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="1.5" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#further-reading-1"><i class="fa fa-check"></i><b>1.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html"><i class="fa fa-check"></i><b>2</b> Biased transmission: direct bias</a><ul>
<li class="chapter" data-level="2.1" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#strength-of-selection"><i class="fa fa-check"></i><b>2.1</b> Strength of selection</a></li>
<li class="chapter" data-level="2.2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#summary-of-the-model-2"><i class="fa fa-check"></i><b>2.2</b> Summary of the model</a></li>
<li class="chapter" data-level="2.3" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#analytical-appendix-2"><i class="fa fa-check"></i><b>2.3</b> Analytical appendix</a></li>
<li class="chapter" data-level="2.4" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#further-reading-2"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html"><i class="fa fa-check"></i><b>3</b> Biased transmission: frequency-dependent indirect bias</a><ul>
<li class="chapter" data-level="3.1" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#the-logic-of-conformity"><i class="fa fa-check"></i><b>3.1</b> The logic of conformity</a></li>
<li class="chapter" data-level="3.2" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#testing-conformist-transmission"><i class="fa fa-check"></i><b>3.2</b> Testing conformist transmission</a></li>
<li class="chapter" data-level="3.3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#summary-of-the-model-3"><i class="fa fa-check"></i><b>3.3</b> Summary of the model</a></li>
<li class="chapter" data-level="3.4" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#analytical-appendix-3"><i class="fa fa-check"></i><b>3.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="3.5" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#further-readings"><i class="fa fa-check"></i><b>3.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html"><i class="fa fa-check"></i><b>4</b> Biased transmission: demonstrator-based indirect bias</a><ul>
<li class="chapter" data-level="4.1" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#a-simple-demonstrator-bias"><i class="fa fa-check"></i><b>4.1</b> A simple demonstrator bias</a></li>
<li class="chapter" data-level="4.2" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#predicting-the-winning-trait"><i class="fa fa-check"></i><b>4.2</b> Predicting the ‘winning’ trait</a></li>
<li class="chapter" data-level="4.3" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#summary-of-the-model-4"><i class="fa fa-check"></i><b>4.3</b> Summary of the model</a></li>
<li class="chapter" data-level="4.4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#analytical-appendix-4"><i class="fa fa-check"></i><b>4.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="4.5" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#further-readings-1"><i class="fa fa-check"></i><b>4.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html"><i class="fa fa-check"></i><b>5</b> Vertical and horizontal transmission</a><ul>
<li class="chapter" data-level="5.1" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#vertical-cultural-transmission"><i class="fa fa-check"></i><b>5.1</b> Vertical cultural transmission</a></li>
<li class="chapter" data-level="5.2" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#horizontal-cultural-transmission"><i class="fa fa-check"></i><b>5.2</b> Horizontal cultural transmission</a></li>
<li class="chapter" data-level="5.3" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#summary-of-the-model-5"><i class="fa fa-check"></i><b>5.3</b> Summary of the model</a></li>
<li class="chapter" data-level="5.4" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#analytical-appendix-5"><i class="fa fa-check"></i><b>5.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="5.5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#further-reading-3"><i class="fa fa-check"></i><b>5.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html"><i class="fa fa-check"></i><b>6</b> Multiple traits models</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#introducing-innovation"><i class="fa fa-check"></i><b>6.1</b> Introducing innovation</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#optimising-the-code"><i class="fa fa-check"></i><b>6.2</b> Optimising the code</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#the-distribution-of-popularity"><i class="fa fa-check"></i><b>6.3</b> The distribution of popularity</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#summary-of-the-model-6"><i class="fa fa-check"></i><b>6.4</b> Summary of the model</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#analytical-appendix-6"><i class="fa fa-check"></i><b>6.5</b> Analytical appendix</a></li>
<li class="chapter" data-level="6.6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#further-readings-2"><i class="fa fa-check"></i><b>6.6</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rogers-paradox.html"><a href="rogers-paradox.html"><i class="fa fa-check"></i><b>7</b> Rogers’ Paradox</a><ul>
<li class="chapter" data-level="7.1" data-path="rogers-paradox.html"><a href="rogers-paradox.html#summary-of-the-model-7"><i class="fa fa-check"></i><b>7.1</b> Summary of the model</a></li>
<li class="chapter" data-level="7.2" data-path="rogers-paradox.html"><a href="rogers-paradox.html#further-reading-4"><i class="fa fa-check"></i><b>7.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rogers-paradox-a-solution.html"><a href="rogers-paradox-a-solution.html"><i class="fa fa-check"></i><b>8</b> Rogers’ Paradox: A Solution</a><ul>
<li class="chapter" data-level="8.1" data-path="rogers-paradox-a-solution.html"><a href="rogers-paradox-a-solution.html#summary-of-the-model-8"><i class="fa fa-check"></i><b>8.1</b> Summary of the model</a></li>
<li class="chapter" data-level="8.2" data-path="rogers-paradox-a-solution.html"><a href="rogers-paradox-a-solution.html#further-reading-5"><i class="fa fa-check"></i><b>8.2</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="demography.html"><a href="demography.html"><i class="fa fa-check"></i><b>9</b> Demography</a><ul>
<li class="chapter" data-level="9.1" data-path="demography.html"><a href="demography.html#summary-of-the-model-9"><i class="fa fa-check"></i><b>9.1</b> Summary of the model</a></li>
<li class="chapter" data-level="9.2" data-path="demography.html"><a href="demography.html#analytical-appendix-and-further-readings"><i class="fa fa-check"></i><b>9.2</b> Analytical appendix and further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="social-network-structure.html"><a href="social-network-structure.html"><i class="fa fa-check"></i><b>10</b> Social network structure</a><ul>
<li class="chapter" data-level="10.1" data-path="social-network-structure.html"><a href="social-network-structure.html#the-basics"><i class="fa fa-check"></i><b>10.1</b> The Basics</a></li>
<li class="chapter" data-level="10.2" data-path="social-network-structure.html"><a href="social-network-structure.html#plotting-networks"><i class="fa fa-check"></i><b>10.2</b> Plotting networks</a></li>
<li class="chapter" data-level="10.3" data-path="social-network-structure.html"><a href="social-network-structure.html#analyse-social-networks"><i class="fa fa-check"></i><b>10.3</b> Analyse social networks</a><ul>
<li class="chapter" data-level="10.3.1" data-path="social-network-structure.html"><a href="social-network-structure.html#network-properties"><i class="fa fa-check"></i><b>10.3.1</b> Network properties</a></li>
<li class="chapter" data-level="10.3.2" data-path="social-network-structure.html"><a href="social-network-structure.html#vertex-properties"><i class="fa fa-check"></i><b>10.3.2</b> Vertex properties</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="social-network-structure.html"><a href="social-network-structure.html#using-social-networks-to-model-information-transmission"><i class="fa fa-check"></i><b>10.4</b> Using social networks to model information transmission</a><ul>
<li class="chapter" data-level="10.4.1" data-path="social-network-structure.html"><a href="social-network-structure.html#gossip-transmission-on-networked-populations"><i class="fa fa-check"></i><b>10.4.1</b> Gossip transmission on networked populations</a></li>
<li class="chapter" data-level="10.4.2" data-path="social-network-structure.html"><a href="social-network-structure.html#how-does-network-structure-affect-information-transmission"><i class="fa fa-check"></i><b>10.4.2</b> How does network structure affect information transmission?</a></li>
<li class="chapter" data-level="10.4.3" data-path="social-network-structure.html"><a href="social-network-structure.html#complex-versus-simple-contagion"><i class="fa fa-check"></i><b>10.4.3</b> Complex versus simple contagion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="group-structure.html"><a href="group-structure.html"><i class="fa fa-check"></i><b>11</b> Group structured populations and migration</a></li>
<li class="chapter" data-level="12" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html"><i class="fa fa-check"></i><b>12</b> Reproduction and transformation</a><ul>
<li class="chapter" data-level="12.1" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#emergent-similarity"><i class="fa fa-check"></i><b>12.1</b> Emergent similarity</a></li>
<li class="chapter" data-level="12.2" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#cultural-fitness"><i class="fa fa-check"></i><b>12.2</b> Cultural fitness</a></li>
<li class="chapter" data-level="12.3" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#summary-of-the-model-10"><i class="fa fa-check"></i><b>12.3</b> Summary of the model</a></li>
<li class="chapter" data-level="12.4" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#analytical-appendix-7"><i class="fa fa-check"></i><b>12.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="12.5" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#further-readings-3"><i class="fa fa-check"></i><b>12.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html"><i class="fa fa-check"></i><b>13</b> Social learning of social learning rules</a><ul>
<li class="chapter" data-level="13.1" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#openness-and-conservatism"><i class="fa fa-check"></i><b>13.1</b> Openness and conservatism</a></li>
<li class="chapter" data-level="13.2" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#maintaining-open-populations"><i class="fa fa-check"></i><b>13.2</b> Maintaining open populations</a></li>
<li class="chapter" data-level="13.3" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#summary-of-the-model-11"><i class="fa fa-check"></i><b>13.3</b> Summary of the model</a></li>
<li class="chapter" data-level="13.4" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#analytical-appendix-8"><i class="fa fa-check"></i><b>13.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="13.5" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#further-readings-4"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html"><i class="fa fa-check"></i><b>14</b> Traits inter-dependence</a><ul>
<li class="chapter" data-level="14.1" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#compatible-and-incompatible-traits"><i class="fa fa-check"></i><b>14.1</b> Compatible and incompatible traits</a></li>
<li class="chapter" data-level="14.2" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#many-traits-model"><i class="fa fa-check"></i><b>14.2</b> Many-traits model</a></li>
<li class="chapter" data-level="14.3" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#summary-of-the-model-12"><i class="fa fa-check"></i><b>14.3</b> Summary of the model</a></li>
<li class="chapter" data-level="14.4" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#analytical-appendix-9"><i class="fa fa-check"></i><b>14.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="14.5" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#further-readings-5"><i class="fa fa-check"></i><b>14.5</b> Further readings</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Individual-based models of cultural evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="group-structure" class="section level1">
<h1><span class="header-section-number">11</span> Group structured populations and migration</h1>
<p>Many simulations assume well-mixed populations, that is, populations of individuals that haven an equal chance of encountering each other. In many situations, this is a reasonable approximiation of the real-world. However,
In the previous chapters, we have assumed that all individuals in our simulations are equally likely to interact with each other. . In many situations, this is a justified assumption, for example, when looking at a small population or a limited geographic area. Sometimes, however, populations are subdivided into groups were individuals are more likely to interact with others within and less with those outside their group.</p>
<p>In this chapter, we will simulate subdivided populations and test how this affects the spread of a new trait across groups and the population. We will also simulate the diffusion of traits in a population based on migration events between groups.</p>
<p>Let us start simply with one large population where individuals acquire a behavioural trait from a random individual in their population</p>
<p>We will start with two behaviours that are about equally represented in the population:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">popsize &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">nbehaviour &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>nbehaviour, <span class="dt">size=</span>popsize, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">table</span>(traits)</a></code></pre></div>
<pre><code>## traits
##  1  2 
## 44 56</code></pre>
<p>Now we add a loop to select a random individaul (which is only represented as a behaviour along the poptraits vector) and let this individual copy a random other individual:
We will also add a reporting variable to keep an eye on the frequency of traits</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">ntimesteps &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>ntimesteps, <span class="dt">ncol=</span>nbehaviour)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>ntimesteps){</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="co"># choose a random observer and a random individual to observe </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>popsize, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="co"># record the frequency of each trait in each timestep</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">table</span>(traits)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">}</a></code></pre></div>
<p>Let us have a look at the time line for this simulation:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;behaviour&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">ggplot</span>(rectraits_d) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq<span class="op">/</span>popsize, <span class="dt">col=</span><span class="kw">factor</span>(behaviour))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>As we have seen in the chapter on unbiased transmission (REF), the frequency of the two traits will move around 0.5. For smaller populations, more traits, or longer time drift will lead to the exclusion of one of the traits. We can test this by using a much smaller population:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">popsize &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">nbehaviour &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">ntimesteps &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(POPSIZE, NBEHAVIOUR, NTIMESTEPS){</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NBEHAVIOUR, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NBEHAVIOUR)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="co"># choose a random observer and a random individual to observe </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">    observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">    <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">    traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">table</span>(traits))</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">  }</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  <span class="kw">return</span>(rectraits)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">POPSIZE=</span>popsize, <span class="dt">NBEHAVIOUR=</span>nbehaviour, <span class="dt">NTIMESTEPS=</span>ntimesteps)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(res)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;behaviour&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="kw">ggplot</span>(rectraits_d) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq<span class="op">/</span>popsize, <span class="dt">col=</span><span class="kw">factor</span>(behaviour))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Now let us assume that the population we are looking at is subdivided into two clusters.
We will keep track which individual belongs to which cluster and then record the frequency of one of the traits (with two traits knowing the frequency of one is telling you the frequency of the other) in each cluster:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">npop &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">popsize &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">nbehaviour &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">ntimesteps &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS){</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NBEHAVIOUR, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  cluster &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NPOP, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NPOP)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">    <span class="co"># choose a random observer and a random individual to observe </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">    observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F)</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">    <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">    traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>( traits[cluster<span class="op">==</span><span class="dv">1</span>]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">                              <span class="kw">sum</span>( traits[cluster<span class="op">==</span><span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  <span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cluster&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  <span class="kw">return</span>(rectraits_d)</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb6-24" data-line-number="24"></a>
<a class="sourceLine" id="cb6-25" data-line-number="25">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span>npop, <span class="dt">POPSIZE=</span>popsize, <span class="dt">NBEHAVIOUR=</span>nbehaviour, <span class="dt">NTIMESTEPS=</span>ntimesteps)</a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>If you rund this code repeatedly, you will see that on average the frequency of the behaviour will still be around 0.5 and that the frequency in both clusters is correlated. This is what we expect because individuals do not choose one over the other cluster to learn from.</p>
<p>With a small change in the line where we record the frequency of traits, we can make this code work for more than two clusters:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">npop &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">popsize &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">nbehaviour &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">ntimesteps &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS){</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NBEHAVIOUR, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  cluster &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NPOP, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NPOP)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb7-11" data-line-number="11">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    <span class="co"># choose a random observer and a random individual to observe </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">    observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">    <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">    traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>NPOP, <span class="cf">function</span>(x) <span class="kw">sum</span>( traits[cluster<span class="op">==</span>x]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span>x)))</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb7-19" data-line-number="19">  rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">  <span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cluster&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">  <span class="kw">return</span>(rectraits_d)</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb7-23" data-line-number="23"></a>
<a class="sourceLine" id="cb7-24" data-line-number="24">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span>npop, <span class="dt">POPSIZE=</span>popsize, <span class="dt">NBEHAVIOUR=</span>nbehaviour, <span class="dt">NTIMESTEPS=</span>ntimesteps)</a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>So far, an individual is equally likely to learn from any other individual in the entire population. What would happen if clusters were completely isolated from each other, and so an individaul would only learn from within its cluster? One way to do this is to change the sample function that selects a cultural model. Instead of selecting among all individuals, we limit it to individuals in the same cluster (same cluster ID). In anticipation of migration, let’s also add an if statement to check whether there is any model left in that cluster:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">npop &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">popsize &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">nbehaviour &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">ntimesteps &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS){</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NBEHAVIOUR, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  cluster &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>NPOP, <span class="dt">size=</span>POPSIZE, <span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NPOP)</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb8-11" data-line-number="11">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">    <span class="co"># choose a random cluster</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">    clusterid &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">    <span class="co"># if there are at least two individuals in this cluster</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15">    <span class="cf">if</span>(<span class="kw">sum</span>(cluster<span class="op">==</span>clusterid)<span class="op">&gt;</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">      <span class="co"># choose a random observer and a random individual to observe within the same cluster </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17">      observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F, <span class="dt">prob=</span>(cluster<span class="op">==</span>clusterid)<span class="op">*</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-18" data-line-number="18">      <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19">      traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">    }</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>npop, <span class="cf">function</span>(x) <span class="kw">sum</span>( traits[cluster<span class="op">==</span>x]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span>x)))</a>
<a class="sourceLine" id="cb8-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb8-24" data-line-number="24">  rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">  <span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cluster&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">  <span class="kw">return</span>(rectraits_d)</a>
<a class="sourceLine" id="cb8-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb8-28" data-line-number="28"></a>
<a class="sourceLine" id="cb8-29" data-line-number="29">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span>npop, <span class="dt">POPSIZE=</span>popsize, <span class="dt">NBEHAVIOUR=</span>nbehaviour, <span class="dt">NTIMESTEPS=</span>ntimesteps)</a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>When you run this simulation repeatedly, you will see that sometimes one of the behaviours gets lost in one, both, or neither of the clusters.</p>
<p>Let’s test that these clusters are in fact independent by fixing each population to one of the two behaviours:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS){</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  traits &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>NBEHAVIOUR, <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  cluster &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>NPOP, <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NPOP)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="co"># choose a random cluster</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    clusterid &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    <span class="co"># if there are at least two individuals in this cluster</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    <span class="cf">if</span>(<span class="kw">sum</span>(cluster<span class="op">==</span>clusterid)<span class="op">&gt;</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">      <span class="co"># choose a random observer and a random individual to observe within the same cluster </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">      observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F, <span class="dt">prob=</span>(cluster<span class="op">==</span>clusterid)<span class="op">*</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">      <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">      traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>npop, <span class="cf">function</span>(x) <span class="kw">sum</span>( traits[cluster<span class="op">==</span>x]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span>x)))</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  <span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cluster&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">  <span class="kw">return</span>(rectraits_d)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb9-23" data-line-number="23"></a>
<a class="sourceLine" id="cb9-24" data-line-number="24">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">50</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Now, let us change the code to allow migration between the clusters.</p>
<ul>
<li>real migration (change cluster id)</li>
<li>cultural migration (learn from a different cluster also)</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">migrationModel &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS, MIGRATION){</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="co"># traits &lt;- sample(x=NBEHAVIOUR, size=POPSIZE, replace=TRUE)</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="co"># cluster &lt;- sample(x=NPOP, size=POPSIZE, replace=TRUE)</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  traits &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>NBEHAVIOUR, <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  cluster &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">sample</span>(NPOP), <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  rectraits &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>NTIMESTEPS, <span class="dt">ncol=</span>NPOP)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    <span class="co"># choose a random cluster</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    clusterid &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">    <span class="co"># if there are at least two individuals in this cluster</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">    <span class="cf">if</span>(<span class="kw">sum</span>(cluster<span class="op">==</span>clusterid)<span class="op">&gt;</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">      <span class="co"># choose a random observer and a random individual to observe within the same cluster </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13">      observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F, <span class="dt">prob=</span>(cluster<span class="op">==</span>clusterid)<span class="op">*</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">      <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">      traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">    }</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">    <span class="co"># migrate</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18">    <span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span>MIGRATION){</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">      cluster[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">    }</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">    rectraits[timestep,] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>npop, <span class="cf">function</span>(x) <span class="kw">sum</span>( traits[cluster<span class="op">==</span>x]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span>x)))</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb10-24" data-line-number="24">  rectraits_d &lt;-<span class="st"> </span><span class="kw">melt</span>(rectraits)</a>
<a class="sourceLine" id="cb10-25" data-line-number="25">  <span class="kw">colnames</span>(rectraits_d) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;cluster&quot;</span>,<span class="st">&quot;freq&quot;</span>)</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">  <span class="kw">return</span>(rectraits_d)</a>
<a class="sourceLine" id="cb10-27" data-line-number="27">}</a></code></pre></div>
<p>If we leave migration at zero, we still find that the behaviours in the two clusters are independent from each other:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">50</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>At the other extreme (migration equal to 1), we find that the frequency of the behaviours becomes correlated as more and more individuals keep moving between the clusters. It is as if there were not clusters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">100</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>For rare migration, we can find occassional changes in the frequency but it usually bounces back.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">100</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">ggplot</span>(res) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>freq, <span class="dt">col=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Relative frequency of behaviour 1&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Now, let’s check how correlated the groups are. To do so, run repeatedly (100) and check correlation between end points of the two populations, do this for different migration rates.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">repeatedRun &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, </a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="cf">function</span>(run){</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">    <span class="co"># run individual simulation</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    res &lt;-<span class="st"> </span><span class="kw">migrationModel</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">100</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span>.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    <span class="co"># return only the frequency for each cluster at the last time step</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    resLast &lt;-<span class="st"> </span>res[res[,<span class="st">&quot;time&quot;</span>]<span class="op">==</span><span class="kw">max</span>(res[,<span class="st">&quot;time&quot;</span>]),<span class="st">&quot;freq&quot;</span>]</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="kw">return</span>(resLast)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  })</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(repeatedRun)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>V1, <span class="dt">y=</span>V2)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency in cluster 1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency in cluster 2&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">mean</span>(<span class="kw">abs</span>(repeatedRun[,<span class="dv">1</span>]<span class="op">-</span>repeatedRun[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] 0.1095869</code></pre>
<p>let’s change the function so that the model will return the analysis right away</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">migrationModelAnalysed &lt;-<span class="st"> </span><span class="cf">function</span>(NPOP, POPSIZE, NBEHAVIOUR, NTIMESTEPS, MIGRATION, REPETITIONS){</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  rectraitsFreq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol=</span>NPOP, <span class="dt">nrow=</span>REPETITIONS)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  <span class="cf">for</span>(repetitions <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>REPETITIONS){</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">    traits &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>NBEHAVIOUR, <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">    cluster &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">sample</span>(NPOP), <span class="dt">each=</span>POPSIZE<span class="op">/</span>NPOP)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">    <span class="cf">for</span>(timestep <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>NTIMESTEPS){</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">      <span class="co"># choose a random cluster</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">      clusterid &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">      <span class="co"># if there are at least two individuals in this cluster</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">      <span class="cf">if</span>(<span class="kw">sum</span>(cluster<span class="op">==</span>clusterid)<span class="op">&gt;</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">        <span class="co"># choose a random observer and a random individual to observe within the same cluster </span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">        observer_model &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>POPSIZE, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span>F, <span class="dt">prob=</span>(cluster<span class="op">==</span>clusterid)<span class="op">*</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">        <span class="co"># let observer acquire trait from model</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">        traits[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span>traits[ observer_model[<span class="dv">2</span>] ]</a>
<a class="sourceLine" id="cb17-15" data-line-number="15">      }</a>
<a class="sourceLine" id="cb17-16" data-line-number="16">      <span class="co"># migrate</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">      <span class="cf">if</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span>MIGRATION){</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">        cluster[ observer_model[<span class="dv">1</span>] ] &lt;-<span class="st"> </span><span class="kw">sample</span>(npop, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">      }</a>
<a class="sourceLine" id="cb17-20" data-line-number="20">    }</a>
<a class="sourceLine" id="cb17-21" data-line-number="21">    rectraitsFreq[repetitions, ] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>npop, <span class="cf">function</span>(x) <span class="kw">sum</span>( traits[cluster<span class="op">==</span>x]<span class="op">==</span><span class="dv">1</span> ) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(cluster<span class="op">==</span>x))) </a>
<a class="sourceLine" id="cb17-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb17-23" data-line-number="23"></a>
<a class="sourceLine" id="cb17-24" data-line-number="24">  <span class="kw">return</span>(</a>
<a class="sourceLine" id="cb17-25" data-line-number="25">  <span class="kw">data.frame</span>(<span class="dt">migration=</span>MIGRATION, </a>
<a class="sourceLine" id="cb17-26" data-line-number="26">             <span class="co"># rsq      = cor(x=rectraitsFreq[,1], y=rectraitsFreq[,2])^2,</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27">             <span class="dt">absdiff  =</span> <span class="kw">mean</span>(<span class="kw">abs</span>(rectraitsFreq[,<span class="dv">1</span>]<span class="op">-</span>rectraitsFreq[,<span class="dv">2</span>])))</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">  )</a>
<a class="sourceLine" id="cb17-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb17-30" data-line-number="30"></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="kw">migrationModelAnalysed</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">100</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span>.<span class="dv">125</span>, <span class="dt">REPETITIONS=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>##   migration    absdiff
## 1     0.125 0.07113636</code></pre>
<p>Now we can easily run this simulation for various different values of migration rates</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">repeatedRun &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  <span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">1</span>, <span class="dt">by=</span><span class="fl">0.05</span>), <span class="cf">function</span>(migration){</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="co"># lapply(runif(n=50, min=0, max=1), function(migration){</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    <span class="kw">migrationModelAnalysed</span>(<span class="dt">NPOP=</span><span class="dv">2</span>, <span class="dt">POPSIZE=</span><span class="dv">100</span>, <span class="dt">NBEHAVIOUR=</span><span class="dv">2</span>, <span class="dt">NTIMESTEPS=</span><span class="dv">1000</span>, <span class="dt">MIGRATION=</span>migration, <span class="dt">REPETITIONS=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">  })</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="kw">ggplot</span>(repeatedRun) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>migration, <span class="dt">y=</span>absdiff)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Migration rate&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Average frequency difference between clusters&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="social-network-structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproduction-and-transformation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
