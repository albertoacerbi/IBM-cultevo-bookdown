<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Reproduction and transformation | Individual-based models of cultural evolution</title>
  <meta name="description" content="A minimal working structure for the book" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Reproduction and transformation | Individual-based models of cultural evolution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A minimal working structure for the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Reproduction and transformation | Individual-based models of cultural evolution" />
  
  <meta name="twitter:description" content="A minimal working structure for the book" />
  

<meta name="author" content="Alberto Acerbi" />
<meta name="author" content="Alex Mesoudi" />
<meta name="author" content="Marco Smolla" />


<meta name="date" content="2020-01-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="social-network-structure.html"/>
<link rel="next" href="social-learning-of-social-learning-rules.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Individual-based models of cultural evolution</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Basics</b></span><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#initialising-the-simulation"><i class="fa fa-check"></i><b>0.1</b> Initialising the simulation</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#execute-generation-turn-over-many-times"><i class="fa fa-check"></i><b>0.2</b> Execute generation turn-over many times</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#plotting-the-model-results"><i class="fa fa-check"></i><b>0.3</b> Plotting the model results</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#write-a-function-to-wrap-the-model-code"><i class="fa fa-check"></i><b>0.4</b> Write a function to wrap the model code</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#run-several-independent-simulations-and-plot-their-results"><i class="fa fa-check"></i><b>0.5</b> Run several independent simulations and plot their results</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#varying-initial-conditions"><i class="fa fa-check"></i><b>0.6</b> Varying initial conditions</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#summary-of-the-model"><i class="fa fa-check"></i><b>0.7</b> Summary of the model</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#analytical-appendix"><i class="fa fa-check"></i><b>0.8</b> Analytical appendix</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#further-reading"><i class="fa fa-check"></i><b>0.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html"><i class="fa fa-check"></i><b>1</b> Unbiased and biased mutation</a><ul>
<li class="chapter" data-level="1.1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#unbiased-mutation"><i class="fa fa-check"></i><b>1.1</b> Unbiased mutation</a></li>
<li class="chapter" data-level="1.2" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#biased-mutation"><i class="fa fa-check"></i><b>1.2</b> Biased mutation</a></li>
<li class="chapter" data-level="1.3" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#summary-of-the-model-1"><i class="fa fa-check"></i><b>1.3</b> Summary of the model</a></li>
<li class="chapter" data-level="1.4" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#analytical-appendix-1"><i class="fa fa-check"></i><b>1.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="1.5" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#further-reading-1"><i class="fa fa-check"></i><b>1.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html"><i class="fa fa-check"></i><b>2</b> Biased transmission: direct bias</a><ul>
<li class="chapter" data-level="2.1" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#strentgh-of-selection"><i class="fa fa-check"></i><b>2.1</b> Strentgh of selection</a></li>
<li class="chapter" data-level="2.2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#summary-of-the-model-2"><i class="fa fa-check"></i><b>2.2</b> Summary of the model</a></li>
<li class="chapter" data-level="2.3" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#analytical-appendix-2"><i class="fa fa-check"></i><b>2.3</b> Analytical appendix</a></li>
<li class="chapter" data-level="2.4" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#further-reading-2"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html"><i class="fa fa-check"></i><b>3</b> Biased transmission: frequency-dependent indirect bias</a><ul>
<li class="chapter" data-level="3.1" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#the-logic-of-conformity"><i class="fa fa-check"></i><b>3.1</b> The logic of conformity</a></li>
<li class="chapter" data-level="3.2" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#testing-conformist-transmission"><i class="fa fa-check"></i><b>3.2</b> Testing conformist transmission</a></li>
<li class="chapter" data-level="3.3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#summary-of-the-model-3"><i class="fa fa-check"></i><b>3.3</b> Summary of the model</a></li>
<li class="chapter" data-level="3.4" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#analytical-appendix-3"><i class="fa fa-check"></i><b>3.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="3.5" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#further-readings"><i class="fa fa-check"></i><b>3.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html"><i class="fa fa-check"></i><b>4</b> Biased transmission: demonstrator-based indirect bias</a><ul>
<li class="chapter" data-level="4.1" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#a-simple-demonstrator-bias"><i class="fa fa-check"></i><b>4.1</b> A simple demonstrator bias</a></li>
<li class="chapter" data-level="4.2" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#predicting-the-winning-trait"><i class="fa fa-check"></i><b>4.2</b> Predicting the ‘winning’ trait</a></li>
<li class="chapter" data-level="4.3" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#summary-of-the-model-4"><i class="fa fa-check"></i><b>4.3</b> Summary of the model</a></li>
<li class="chapter" data-level="4.4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#analytical-appendix-4"><i class="fa fa-check"></i><b>4.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="4.5" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#further-readings-1"><i class="fa fa-check"></i><b>4.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html"><i class="fa fa-check"></i><b>5</b> Vertical and horizontal transmission</a><ul>
<li class="chapter" data-level="5.1" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#vertical-cultural-transmission"><i class="fa fa-check"></i><b>5.1</b> Vertical cultural transmission</a></li>
<li class="chapter" data-level="5.2" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#horizontal-cultural-transmission"><i class="fa fa-check"></i><b>5.2</b> Horizontal cultural transmission</a></li>
<li class="chapter" data-level="5.3" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#summary-of-the-model-5"><i class="fa fa-check"></i><b>5.3</b> Summary of the model</a></li>
<li class="chapter" data-level="5.4" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#analytical-appendix-5"><i class="fa fa-check"></i><b>5.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="5.5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#further-reading-3"><i class="fa fa-check"></i><b>5.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html"><i class="fa fa-check"></i><b>6</b> Multiple traits models</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#introducing-innovation"><i class="fa fa-check"></i><b>6.1</b> Introducing innovation</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#optimising-the-code"><i class="fa fa-check"></i><b>6.2</b> Optimising the code</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#the-distribution-of-popularity"><i class="fa fa-check"></i><b>6.3</b> The distribution of popularity</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#summary-of-the-model-6"><i class="fa fa-check"></i><b>6.4</b> Summary of the model</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#analytical-appendix-6"><i class="fa fa-check"></i><b>6.5</b> Analytical appendix</a></li>
<li class="chapter" data-level="6.6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#further-readings-2"><i class="fa fa-check"></i><b>6.6</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="group-structure.html"><a href="group-structure.html"><i class="fa fa-check"></i><b>7</b> Group structured populations and migration</a></li>
<li class="chapter" data-level="8" data-path="social-network-structure.html"><a href="social-network-structure.html"><i class="fa fa-check"></i><b>8</b> Social network structure</a></li>
<li class="chapter" data-level="9" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html"><i class="fa fa-check"></i><b>9</b> Reproduction and transformation</a><ul>
<li class="chapter" data-level="9.1" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#emergent-similarity"><i class="fa fa-check"></i><b>9.1</b> Emergent similarity</a></li>
<li class="chapter" data-level="9.2" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#cultural-fitness"><i class="fa fa-check"></i><b>9.2</b> Cultural fitness</a></li>
<li class="chapter" data-level="9.3" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#summary-of-the-model-7"><i class="fa fa-check"></i><b>9.3</b> Summary of the model</a></li>
<li class="chapter" data-level="9.4" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#analytical-appendix-7"><i class="fa fa-check"></i><b>9.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="9.5" data-path="reproduction-and-transformation.html"><a href="reproduction-and-transformation.html#further-readings-3"><i class="fa fa-check"></i><b>9.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html"><i class="fa fa-check"></i><b>10</b> Social learning of social learning rules</a><ul>
<li class="chapter" data-level="10.1" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#openness-and-conservatism"><i class="fa fa-check"></i><b>10.1</b> Openness and conservatism</a></li>
<li class="chapter" data-level="10.2" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#maintaining-open-populations"><i class="fa fa-check"></i><b>10.2</b> Maintaining open populations</a></li>
<li class="chapter" data-level="10.3" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#summary-of-the-model-8"><i class="fa fa-check"></i><b>10.3</b> Summary of the model</a></li>
<li class="chapter" data-level="10.4" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#analytical-appendix-8"><i class="fa fa-check"></i><b>10.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="10.5" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#further-readings-4"><i class="fa fa-check"></i><b>10.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html"><i class="fa fa-check"></i><b>11</b> Traits inter-dependence</a><ul>
<li class="chapter" data-level="11.1" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#compatible-and-incompatible-traits"><i class="fa fa-check"></i><b>11.1</b> Compatible and incompatible traits</a></li>
<li class="chapter" data-level="11.2" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#many-traits-model"><i class="fa fa-check"></i><b>11.2</b> Many-traits model</a></li>
<li class="chapter" data-level="11.3" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#summary-of-the-model-9"><i class="fa fa-check"></i><b>11.3</b> Summary of the model</a></li>
<li class="chapter" data-level="11.4" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#analytical-appendix-9"><i class="fa fa-check"></i><b>11.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="11.5" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#further-readings-5"><i class="fa fa-check"></i><b>11.5</b> Further readings</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Individual-based models of cultural evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reproduction-and-transformation" class="section level1">
<h1><span class="header-section-number">9</span> Reproduction and transformation</h1>
<p>To be considered “cultural”, ideas, behaviours, and artifacts need to be sufficiently stable in time. The version of <em>Little Red Riding Hood</em> we heard now is part of a long cultural transmission chain that includes all the other versions of the tale because they all share <em>enough</em> features to be considered the same tale. Similarly, the lasagne I cooked yesterday are part of a long, intricate, chain of cultural transmission events, where all the products are stable enough that we can consider one cultural trait as <em>lasagne</em>. Boundaries are muddled for many traits: while some artifacts can be the exact replica of each other, no two identical lasagne exist. In any case, the question we explore in this chapter is: how does this stability is brought about? In the models so far, as much as in the majority of models in cultural evolution, we assumed that traits are copied from one (cultural) generation to another with enough fidelity to assure a relative stability. This is a useful assumption and, in many case, a good approximation of what happens in reality.</p>
<p>However, cultural traits can also be stable not because they are copied with high-fidelity, but also because when passing from an individual to another they are independently reconstructed in the same way or, another way to say it, they become similar to each other through a process of convergent transformation. Think about whistling. We do learn to whistle from each other through a process of cultural transmission (we want to reproduce what others do), but the configuration of the muscles in the mouth is not something that we copy directly. Still, there are few ways to effectively whistle, so they we likely end up with the same - or similar - configuration. (Notice we can also actually copy the exact configuration and, indeed, there are specialised whistling techniques for which it is required. As we will discuss later, copying and reconstructing are not two alternative processes, but they both concur to cultural evolution.)</p>
<p>To have a better grasp of the consequence of this idea we can, as usual, try to model a very simple case, where cultural stability can be obtained with a process of copying and selection of a model, as we did in many of the previous chapters, or with convergent transformation, where individuals are not very good at copying, or at selecting models, but they tend to transform the trait in the same way.</p>
<p>Let’s imagine a population with a single trait, a continuous trait <span class="math inline">\(P\)</span>, that can have values between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. At the beginning of the simulations, <span class="math inline">\(P\)</span> is uniformly distributed in the population. Let’s say the optimal value of <span class="math inline">\(P\)</span> is <span class="math inline">\(1\)</span> (this is convenient for the code, but the exact value is not important). You can think to <span class="math inline">\(P\)</span> as, for example, how sharp is a knife: the more the better.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">111</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a></code></pre></div>
<p>Now, we can write the familiar function where individuals copy the trait from the previous generation with one of the biases we explored earlier in the book. In <a href="biased-transmission-direct-bias.html#biased-transmission-direct-bias">Chapter 3</a>, for example, we showed how a direct bias for one of two discrete cultural traits could make it spread and go to fixation. We can do something similar here, with the difference that the trait is continuous and the bias needs to be a preference for traits close to the optimal value. (Notice the code would be equivalent - and we would obtain the same effect of convergence to optimal value - thinking in terms of other methods of cultural selection, e.g. and indirect bias towards successful demonstrators, that are successful as they have a <span class="math inline">\(P\)</span> close to the optimal).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">reproduction &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max, mu) {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P1 =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">P2 =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">      copy &lt;-<span class="st"> </span><span class="kw">pmax</span>(demonstrators<span class="op">$</span>P1, demonstrators<span class="op">$</span>P2)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">      population<span class="op">$</span>P &lt;-<span class="st"> </span>copy <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="op">-</span>mu, <span class="op">+</span>mu)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">    }</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">}</a></code></pre></div>
<p>The function is similar to what we have already done several times. Let’s have a look at the few differences. First, we find again the parameter <span class="math inline">\(\mu\)</span>, as done for <a href="unbiased-and-biased-mutation.html#unbiased-and-biased-mutation">biased mutation</a> and <a href="multiple-traits-models.html#multiple-traits-models">innovation</a> in previous chapters. Similarly, it implements here the error in copying: with respect to the <span class="math inline">\(P\)</span> of the demonstrator chosen, the new trait will vary of maximum of <span class="math inline">\(\mu\)</span>, through the instruction <code>runif(N, -mu, +mu)</code>. The two following lines just keep the traits in the boundaries between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. The second difference is in the selection of the trait to copy. Here each individual sample two traits (or demonstrators) from the previous generation, and simply copies the one with the trait closer to the optimal value of <span class="math inline">\(1\)</span>.</p>
<p>We can now run the simulation, and plot it with a slightly modified function <code>plot_multiple_runs_p()</code> (we just need to change the label for y-axis). We use a low value for the copying error such as <span class="math inline">\(\mu=0.05\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">plot_multiple_runs_p &lt;-<span class="st"> </span><span class="cf">function</span>(data_model) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw">ggplot</span>(<span class="dt">data =</span> data_model, <span class="kw">aes</span>(<span class="dt">y =</span> p, <span class="dt">x =</span> generation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> run)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">    </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;p (average value of P)&quot;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">}</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">data_model &lt;-<span class="st"> </span><span class="kw">reproduction</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>, <span class="dt">mu =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">plot_multiple_runs_p</span>(data_model)</a></code></pre></div>
<p><img src="_main_files/figure-html/13.4-1.png" width="672" /></p>
<p>Even with a weak form of selection (sampling two traits and choosing the better one) the population converges on the optimal value quickly, in only around ten cultural generations.</p>
<p>Now we can write another function where convergent transformation produces the same effect.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">transformation &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)))</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">      </a>
<a class="sourceLine" id="cb5-11" data-line-number="11">      population<span class="op">$</span>P &lt;-<span class="st"> </span>demonstrators<span class="op">$</span>P <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="dt">max =</span> <span class="dv">1</span><span class="op">-</span>demonstrators<span class="op">$</span>P)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">      </a>
<a class="sourceLine" id="cb5-13" data-line-number="13">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    }</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">  }</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">}</a></code></pre></div>
<p>There is only a line we need to pay attention to: the values of <span class="math inline">\(P\)</span> of the new generation are calculated as <code>demonstrators$P + runif(N, max = 1-demonstrators$P)</code>. This means that the individuals of the new population copy the old generation, but they are not particularly good. They take a value of <span class="math inline">\(P\)</span> randomly drawn between the value of the demonstrator and the optimal <span class="math inline">\(P=1\)</span>. Thus, if they attempt to copy a demonstrator with <span class="math inline">\(P=0.1\)</span>, their “error” can be as large as 0.9. Let’s run the simulations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">data_model &lt;-<span class="st"> </span><span class="kw">transformation</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">plot_multiple_runs_p</span>(data_model)</a></code></pre></div>
<p><img src="_main_files/figure-html/13.6-1.png" width="672" /></p>
<p>As the transformations tend to all converge in the same direction, the results are equivalent to the previous model. It does not matter when exactly the population reaches stability at <span class="math inline">\(P=1\)</span>, as this depends on the specific implementation choices, for example the strength of cultural selection in the first model, or how big can be the “jump” of the transformation in the second model.</p>
<p>When we see cultural traits in real life, we are observing systems in a state analogous to what happens on the right side of the two plots, where individuals reproduce traits one similar to the other. As we mentioned earlier in the chapter, both faithful copying and transformation can be important for culture, and their importance can depend from the specific features we are interested to track, or from the cultural domain. As we have just shown, however, the spread of the traits in the population looks similar in both cases. Are there ways to distinguish the relative importance of the two processes?</p>
<div id="emergent-similarity" class="section level2">
<h2><span class="header-section-number">9.1</span> Emergent similarity</h2>
<p>One possibility is to track how similar are the traits that the observers reproduce, with respect to the traits they use as a starting point. If reproduction is the driving force, they should be fairly similar and the measure should be always the same, as the distance between the trait produced and the trait copied is fixed, and given by the parameter <span class="math inline">\(\mu\)</span>. If transformation is the driving force, instead, we should expect similarity being lower when traits are far from the optimal value (i.e. at the beginning of the simulations) - remember their <span class="math inline">\(P\)</span> is randomly drawn between the value of the demonstrator and the optimal <span class="math inline">\(P=1\)</span> - and higher when traits are close to the optimal value.</p>
<p>We can rewrite the <code>reproduction()</code> and <code>transformation()</code> functions adding as a further output this measure of similarity, that is, how distant are the traits that the new generation show to the traits that they had copied from the previous. We thus add a variable <em>d</em> (as in “distance”) in our <code>output</code> tibble, and we calculate this value at the end of each generation as <code>sum(abs(population$P - copy)) / N</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">reproduction &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max, mu) {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)), <span class="dt">d =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P1 =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="dt">P2 =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">      copy &lt;-<span class="st"> </span><span class="kw">pmax</span>(demonstrators<span class="op">$</span>P1, demonstrators<span class="op">$</span>P2)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">      population<span class="op">$</span>P &lt;-<span class="st"> </span>copy <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="op">-</span>mu, <span class="op">+</span>mu)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>d &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(population<span class="op">$</span>P <span class="op">-</span><span class="st"> </span>copy)) <span class="op">/</span><span class="st"> </span>N</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">}</a></code></pre></div>
<p>We do the same for the <code>transformation()</code> function, and we can run again both simulations.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">transformation &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max) {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)), <span class="dt">d =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">sample</span>(previous_population<span class="op">$</span>P, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">      </a>
<a class="sourceLine" id="cb8-11" data-line-number="11">      population<span class="op">$</span>P &lt;-<span class="st"> </span>demonstrators<span class="op">$</span>P <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="dt">max =</span> <span class="dv">1</span><span class="op">-</span>demonstrators<span class="op">$</span>P)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">      </a>
<a class="sourceLine" id="cb8-13" data-line-number="13">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>d &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(population<span class="op">$</span>P <span class="op">-</span><span class="st"> </span>demonstrators<span class="op">$</span>P)) <span class="op">/</span><span class="st"> </span>N</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18">}</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">data_model_reproduction &lt;-<span class="st"> </span><span class="kw">reproduction</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>, <span class="dt">mu =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">data_model_transformation &lt;-<span class="st"> </span><span class="kw">transformation</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>We already know the results with respect to the value of <span class="math inline">\(P\)</span>, but now we are interested in comparing if and how the values for <em>d</em> change in time in the two conditions. For this, we write an <em>ad hoc</em> plotting function, that takes the data from the two outputs and plot them in the same graph. Notice the <code>na.omit()</code> function in the first line: the data on <em>d</em> is NA for the first generation, because there is no previous generation from which to take the measure, so we want to exclude it from our plot, and start from generation number 2. For this reason, all the other values are rescaled and, in particular, the variable <em>generation</em> starts from 2.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">data_to_plot &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">distance =</span> <span class="kw">c</span>(<span class="kw">na.omit</span>(data_model_reproduction<span class="op">$</span>d), <span class="kw">na.omit</span>(data_model_transformation<span class="op">$</span>d)), </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                       <span class="dt">condition =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;reproduction&quot;</span>, <span class="st">&quot;transformation&quot;</span>), <span class="dt">each =</span> <span class="dv">95</span>),</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                       <span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                       <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">19</span>)))</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">ggplot</span>(<span class="dt">data =</span> data_to_plot, <span class="kw">aes</span>(<span class="dt">y =</span> distance, <span class="dt">x =</span> generation, <span class="dt">group =</span> run, <span class="dt">color =</span> condition)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;d (average distance observer/demonstrator)&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/13.10-1.png" width="672" /></p>
<p>As predicted, in the “transformation” condition distance is higher at the beginning of the simulation, and reaches zero when all individuals have the optimal value. In the “reproduction” condition, instead, the distance is approximately constant. In fact, it slightly decreases after the first few generations. This is due to the fact that at the beginning, with <span class="math inline">\(P\)</span> randomly distributed in the population, the mutation is effectively drawn between <span class="math inline">\(P-\mu\)</span> and <span class="math inline">\(P+\mu\)</span>, but after a while, when demonstrators have a value close to the optimal <span class="math inline">\(P=1\)</span>, the mutation is only drawn in <span class="math inline">\(P-\mu\)</span>, as values of <span class="math inline">\(P\)</span> higher than <span class="math inline">\(1\)</span> are not allowed.</p>
</div>
<div id="cultural-fitness" class="section level2">
<h2><span class="header-section-number">9.2</span> Cultural fitness</h2>
<p>Another way to look at the difference between the two conditions is to look at the “cultural fitness” of the individuals in the population. More in detail, one can look at how this metric covaries with how good they actually are, that is given by their value of <span class="math inline">\(P\)</span>. We can define <span class="math inline">\(W\)</span>, a measure of cultural fitness, as the number of “cultural offspring” that the individual <span class="math inline">\(i\)</span> has in the next generation. If individual <span class="math inline">\(i\)</span> has been copied by, say, four individuals, its fitness will be <span class="math inline">\(W_i=4\)</span>.</p>
<p>If individuals, or their traits, are selected, as happens in the “reproduction” condition, we expect that individuals with higher values of <span class="math inline">\(P\)</span> have more cultural offspring, thus, that to higher <span class="math inline">\(P\)</span>s correspond higer <span class="math inline">\(W\)</span>s. We expect, in other word, the covarinance between <span class="math inline">\(W\)</span> and <span class="math inline">\(P\)</span> being positive i.e. <span class="math inline">\(cov(W,P)&gt;0\)</span>. On the other hand, in the condition “transformation” there is no selection, so there are no reasons why an individual with higher <span class="math inline">\(P\)</span> produces more cultural offspring. In this case, the covariance should be aronud zero, i.e. <span class="math inline">\(cov(W,P)&gt;0\)</span>.</p>
<p>To calculate cultural fitness, and how it covaries with <span class="math inline">\(P\)</span>, we need to modify again our functions. Let’s start, as before, with <code>reproduction()</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">reproduction &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max, mu) {</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)), <span class="dt">cov_W_P =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">sample</span>(N, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="kw">sample</span>(N, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">      copy &lt;-<span class="st"> </span><span class="kw">max.col</span>(<span class="kw">cbind</span>(previous_population[demonstrators[,<span class="dv">1</span>],], previous_population[demonstrators[,<span class="dv">2</span>],]))</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">      demonstrators &lt;-<span class="st"> </span>demonstrators[<span class="kw">cbind</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span>N, copy)]</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">      fitness &lt;-<span class="st"> </span><span class="kw">tabulate</span>(demonstrators, N) </a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14">      population<span class="op">$</span>P &lt;-<span class="st"> </span>previous_population[demonstrators,]<span class="op">$</span>P <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="op">-</span>mu, <span class="op">+</span>mu)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">      population<span class="op">$</span>P[population<span class="op">$</span>P <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>cov_W_P &lt;-<span class="st"> </span><span class="kw">cov</span>(fitness, previous_population<span class="op">$</span>P) </a>
<a class="sourceLine" id="cb11-19" data-line-number="19">    }</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">  }</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22">}</a></code></pre></div>
<p>The function produces the usual output, but in a different way. To measure <span class="math inline">\(W\)</span>, we need to know the actual individuals that are copied, not only their <span class="math inline">\(P\)</span> values, as we were doing previously. For this reason, the sampling of the demonstrators is done on their indexes (<code>sample(N, N, replace = TRUE)</code>). Then, the indexes are used to retrieve their <span class="math inline">\(P\)</span>, in the two following lines. Finally, we count how many times each index, that is, each individual, is used as deomnstrator, using the function <code>tabulate()</code>, introduced in <a href="multiple-traits-models.html#multiple-traits-models">Chapter 7</a>.</p>
<p>Now we need to do the same for <code>transformation()</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">transformation &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, r_max) {</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)), <span class="dt">cov_W_P =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">P =</span> <span class="kw">runif</span>(N))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    <span class="co"># create first generation</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">      previous_population &lt;-<span class="st"> </span>population <span class="co"># copy individuals to previous_population tibble</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">      demonstrators &lt;-<span class="st"> </span><span class="kw">sample</span>(N, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">      fitness &lt;-<span class="st"> </span><span class="kw">tabulate</span>(demonstrators, N) </a>
<a class="sourceLine" id="cb12-11" data-line-number="11"></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">      </a>
<a class="sourceLine" id="cb12-13" data-line-number="13">      population<span class="op">$</span>P &lt;-<span class="st"> </span>previous_population[demonstrators,]<span class="op">$</span>P <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(N, <span class="dt">max =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>previous_population[demonstrators,]<span class="op">$</span>P)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">      </a>
<a class="sourceLine" id="cb12-15" data-line-number="15">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>P) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>cov_W_P &lt;-<span class="st"> </span><span class="kw">cov</span>(fitness,previous_population<span class="op">$</span>P)</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">  output <span class="co"># export data from function</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20">}</a></code></pre></div>
<p>The loigc is exactly the same, only we do not need to use the indexes to retrieve the <span class="math inline">\(P\)</span> values, as they are not needed to choose demonstrators. At this point, as before, we can run the simulations in the two conditions, and plot the results (the code for the plot is also the same, only the label for the y-axes changes).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">data_model_reproduction &lt;-<span class="st"> </span><span class="kw">reproduction</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>, <span class="dt">mu =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">data_model_transformation &lt;-<span class="st"> </span><span class="kw">transformation</span>(<span class="dt">N =</span> <span class="dv">1000</span>, <span class="dt">t_max =</span> <span class="dv">20</span>, <span class="dt">r_max =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">data_to_plot &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">covariance =</span> <span class="kw">c</span>(<span class="kw">na.omit</span>(data_model_reproduction<span class="op">$</span>cov_W_P), <span class="kw">na.omit</span>(data_model_transformation<span class="op">$</span>cov_W_P)), </a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                       <span class="dt">condition =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;reproduction&quot;</span>, <span class="st">&quot;transformation&quot;</span>), <span class="dt">each =</span> <span class="dv">95</span>),</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                       <span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">                       <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">19</span>)))</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">ggplot</span>(<span class="dt">data =</span> data_to_plot, <span class="kw">aes</span>(<span class="dt">y =</span> covariance, <span class="dt">x =</span> generation, <span class="dt">group =</span> run, <span class="dt">color =</span> condition)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;covariance between cultural fitness and P&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/13.13-1.png" width="672" /></p>
<p>In the “reproduction” condition, the covariance is indeed positive, and decreases gradually close to zero, when all the individuals converge to <span class="math inline">\(P=1\)</span>, as there is no more variation on which selection can act. For the same logic explained for the previous result, it does not reach zero, as mutation keep some variation, and individuals that muted to lower <span class="math inline">\(P\)</span>s are less likely to be selected. As expected, the covariance is equal to zero in the “transformation” condition. This is hardly a surprising result as demonstrators are selected fully at random in the model, but it is important to compare this with what happens with empirical data of real cultural dinamycs, where we can be able to distinguish different underlying stabilising forces.</p>
</div>
<div id="summary-of-the-model-7" class="section level2">
<h2><span class="header-section-number">9.3</span> Summary of the model</h2>
<hr />
</div>
<div id="analytical-appendix-7" class="section level2">
<h2><span class="header-section-number">9.4</span> Analytical appendix</h2>
<hr />
</div>
<div id="further-readings-3" class="section level2">
<h2><span class="header-section-number">9.5</span> Further readings</h2>
<p>The analysis described in the sections Emergent similarity and the cultural fitness are based on the cultural application of the Price Equation</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="social-network-structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="social-learning-of-social-learning-rules.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
