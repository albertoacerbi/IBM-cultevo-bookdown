<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Biased transmission (indirect bias: demonstrator) | Individual-based models of cultural evolution</title>
  <meta name="description" content="A minimal working structure for the book" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Biased transmission (indirect bias: demonstrator) | Individual-based models of cultural evolution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A minimal working structure for the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Biased transmission (indirect bias: demonstrator) | Individual-based models of cultural evolution" />
  
  <meta name="twitter:description" content="A minimal working structure for the book" />
  

<meta name="author" content="Alberto Acerbi" />
<meta name="author" content="Alex Mesoudi" />
<meta name="author" content="Marco Smolla" />


<meta name="date" content="2019-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="biased-transmission-indirect-bias-frequency.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Individual-based models of cultural evolution</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Basics</b></span></li>
<li class="chapter" data-level="1" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html"><i class="fa fa-check"></i><b>1</b> Unbiased transmission</a><ul>
<li class="chapter" data-level="1.1" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#initialising-the-simulation"><i class="fa fa-check"></i><b>1.1</b> Initialising the simulation</a></li>
<li class="chapter" data-level="1.2" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#execute-generation-turn-over-many-times"><i class="fa fa-check"></i><b>1.2</b> Execute generation turn-over many times</a></li>
<li class="chapter" data-level="1.3" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#plotting-the-model-results"><i class="fa fa-check"></i><b>1.3</b> Plotting the model results</a></li>
<li class="chapter" data-level="1.4" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#write-a-function-to-wrap-the-model-code"><i class="fa fa-check"></i><b>1.4</b> Write a function to wrap the model code</a></li>
<li class="chapter" data-level="1.5" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#run-several-independent-simulations-and-plot-their-results"><i class="fa fa-check"></i><b>1.5</b> Run several independent simulations and plot their results</a></li>
<li class="chapter" data-level="1.6" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#varying-initial-conditions"><i class="fa fa-check"></i><b>1.6</b> Varying initial conditions</a></li>
<li class="chapter" data-level="1.7" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#summary-of-the-model"><i class="fa fa-check"></i><b>1.7</b> Summary of the model</a></li>
<li class="chapter" data-level="1.8" data-path="unbiased-transmission.html"><a href="unbiased-transmission.html#analytical-appendix"><i class="fa fa-check"></i><b>1.8</b> Analytical appendix</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html"><i class="fa fa-check"></i><b>2</b> Unbiased and biased mutation</a><ul>
<li class="chapter" data-level="2.1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#unbiased-mutation"><i class="fa fa-check"></i><b>2.1</b> Unbiased mutation</a></li>
<li class="chapter" data-level="2.2" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#biased-mutation"><i class="fa fa-check"></i><b>2.2</b> Biased mutation</a></li>
<li class="chapter" data-level="2.3" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#summary-of-the-model-1"><i class="fa fa-check"></i><b>2.3</b> Summary of the model</a></li>
<li class="chapter" data-level="2.4" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#analytical-appendix-1"><i class="fa fa-check"></i><b>2.4</b> Analytical appendix</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html"><i class="fa fa-check"></i><b>3</b> Biased transmission (direct bias)</a><ul>
<li class="chapter" data-level="3.1" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#strenght-of-selection"><i class="fa fa-check"></i><b>3.1</b> Strenght of selection</a></li>
<li class="chapter" data-level="3.2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#summary-of-the-model-2"><i class="fa fa-check"></i><b>3.2</b> Summary of the model</a></li>
<li class="chapter" data-level="3.3" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#analytical-appendix-2"><i class="fa fa-check"></i><b>3.3</b> Analytical appendix</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="biased-transmission-indirect-bias-frequency.html"><a href="biased-transmission-indirect-bias-frequency.html"><i class="fa fa-check"></i><b>4</b> Biased transmission (indirect bias: frequency)</a><ul>
<li class="chapter" data-level="4.1" data-path="biased-transmission-indirect-bias-frequency.html"><a href="biased-transmission-indirect-bias-frequency.html#the-logic-of-conformity"><i class="fa fa-check"></i><b>4.1</b> The logic of conformity</a></li>
<li class="chapter" data-level="4.2" data-path="biased-transmission-indirect-bias-frequency.html"><a href="biased-transmission-indirect-bias-frequency.html#testing-conformist-transmission"><i class="fa fa-check"></i><b>4.2</b> Testing conformist transmission</a></li>
<li class="chapter" data-level="4.3" data-path="biased-transmission-indirect-bias-frequency.html"><a href="biased-transmission-indirect-bias-frequency.html#summary-of-the-model-3"><i class="fa fa-check"></i><b>4.3</b> Summary of the model</a></li>
<li class="chapter" data-level="4.4" data-path="biased-transmission-indirect-bias-frequency.html"><a href="biased-transmission-indirect-bias-frequency.html#analytic-appendix"><i class="fa fa-check"></i><b>4.4</b> Analytic appendix</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="biased-transmission-indirect-bias-demonstrator.html"><a href="biased-transmission-indirect-bias-demonstrator.html"><i class="fa fa-check"></i><b>5</b> Biased transmission (indirect bias: demonstrator)</a><ul>
<li class="chapter" data-level="5.1" data-path="biased-transmission-indirect-bias-demonstrator.html"><a href="biased-transmission-indirect-bias-demonstrator.html#a-simple-demonstrator-bias"><i class="fa fa-check"></i><b>5.1</b> A simple demonstrator bias</a></li>
<li class="chapter" data-level="5.2" data-path="biased-transmission-indirect-bias-demonstrator.html"><a href="biased-transmission-indirect-bias-demonstrator.html#predicting-the-winning-trait"><i class="fa fa-check"></i><b>5.2</b> Predicting the winning trait</a></li>
<li class="chapter" data-level="5.3" data-path="biased-transmission-indirect-bias-demonstrator.html"><a href="biased-transmission-indirect-bias-demonstrator.html#summary-of-the-model-4"><i class="fa fa-check"></i><b>5.3</b> Summary of the model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Individual-based models of cultural evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="biased-transmission-indirect-bias-demonstrator" class="section level1">
<h1><span class="header-section-number">5</span> Biased transmission (indirect bias: demonstrator)</h1>
<p>In the two previous chapters, we started to examine biased transmission, both based on the characteristics of the traits (or <a href="biased-transmission-direct-bias.html#biased-transmission-direct-bias">direct bias</a>) and on the characteristics of the population. The latter can result from taking into account the frequency of a trait (as we did for <a href="biased-transmission-indirect-bias-frequency.html#biased-transmission-indirect-bias-frequency">conformity</a>) or from taking into account specific features of the demonstrators, which we will look at in this chapter (demonstrator bias is also called ‘model bias’ in cultural evolution).</p>
<p>Whereas the simulations we realised previously are fairly standard, indirect demonstrator-based biased transmission can be implemented in several different ways. Demonstrator biases can result when individuals decide whether to copy or not by taking into account any features of the demonstrators, as long as it is not directly tied to the traits. The most studied demonstrator bias is prestige bias, where individuals are more likely to copy from demonstrators that are considered more ‘prestigious’, for example because other individuals show deference to them. Alternatively, individuals can copy the demonstrators that are more successful, independently from how others judge them, or they can copy individuals that are more similar to them, or older (or younger), and so on. The crux is that the decision is not directly linked to the cultural trait itself.</p>
<div id="a-simple-demonstrator-bias" class="section level2">
<h2><span class="header-section-number">5.1</span> A simple demonstrator bias</h2>
<p>To implement a simple version of demonstrator-biased cultural transmission, we first need to assume that there are some intrinsic differences in the population. Up until now, our populations were described only by the traits they possessed. We now want that individuals have a feature by which some of them can be distinguished from others, and, as a consequence, being more liked to be copied. We can call this feature ‘status’. An individual’s status is a binary variable that could stand for whether they are prestigious or not, old (young) or not (assuming that the time frame of the simulations is sufficienlty short) or any other features that do not change, and that other individuals can use to decide whether to copy from them or not. We can have a parameter <span class="math inline">\(p_s\)</span> that determines the probability an individual have an high or a low status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">set.seed</span>(<span class="dv">111</span>)

N &lt;-<span class="st"> </span><span class="dv">100</span>
p_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">0.5</span>
p_s &lt;-<span class="st"> </span><span class="fl">0.05</span>

population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trait =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_<span class="dv">0</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">0</span>)),
                     <span class="dt">status =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_s, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_s))) </code></pre></div>
<p>We can inspect the tibble by typing its name in the R console</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">population</code></pre></div>
<pre><code>## # A tibble: 100 x 2
##    trait status
##    &lt;chr&gt; &lt;chr&gt; 
##  1 A     low   
##  2 A     low   
##  3 B     low   
##  4 A     low   
##  5 B     low   
##  6 B     low   
##  7 B     low   
##  8 A     low   
##  9 B     low   
## 10 B     high  
## # … with 90 more rows</code></pre>
<p>With <span class="math inline">\(p_s=0.05\)</span> around 5 individuals in a population of 100 will have high status. In this specific case, one of them is individual 10, so it will be one of the individuals that will be likely to be copied more from.</p>
<p>How should the status used to decide whether to copy or not? Again, there are various possibilities. An intuitive way is to assume that the probabilities to pick high-status and low-status individuals as demonstrators are different. So far, when using the function <code>sample</code> to select demonstrators, we did not include any specific probability, so that each individual of the previous generation had the same likelihood to be selected. However, we can pass to the function a vector of probabilites to weight the choice. We can assume that the probability to select high status individuals as demonstrators is always equal to 1 (as in unbiased transmission), but the probability to select low-status individuals is encoded by a further parameter, <span class="math inline">\(p_\text{low}\)</span>: when <span class="math inline">\(p_\text{low}=1\)</span>, the simulations correspond to unbiased transmission, as everybody has the same probability to be chosen, while with <span class="math inline">\(p_\text{low}=0\)</span>, there is a strict model bias, where only high-status individuals are copied.</p>
<p>To implement this, we first store in <code>p_demonstrator</code> the probabilities to be copied for each member of the population:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_low &lt;-<span class="st"> </span><span class="fl">0.01</span>

p_demonstrator &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,N)
p_demonstrator[population<span class="op">$</span>status <span class="op">==</span><span class="st"> &quot;low&quot;</span>] &lt;-<span class="st"> </span>p_low</code></pre></div>
<p>After that, we sample the traits in the population using these probabilities. Notice the instruction <code>if(sum(p_demonstrator) &gt; 0)</code>: this is necessary in case there are not high-status individuals (for example with <span class="math inline">\(p_s\simeq0\)</span>) and the probability to select demonstrators from low-status one is equal to 0. In this case, the total probability would be also equal to 0, and it would generate an error when the function is run. With this instruction, instead, no copying happens, which is what we would expect in this situation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="kw">sum</span>(p_demonstrator) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){
  
  demonstrator_index &lt;-<span class="st"> </span><span class="kw">sample</span> (N, <span class="dt">prob =</span> p_demonstrator, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
  
  population<span class="op">$</span>trait &lt;-<span class="st"> </span>population<span class="op">$</span>trait[demonstrator_index]
  
}</code></pre></div>
<p>As usual, we can wrap everything in a function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biased_transmission_demonstrator &lt;-<span class="st"> </span><span class="cf">function</span>(N, p_<span class="dv">0</span>, p_s, p_low, t_max, r_max) {
  
  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span>r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> t_max)))
  
  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {
    
    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trait =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_<span class="dv">0</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">0</span>)),
                     <span class="dt">status =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_s, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_s))) 
    
    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>trait <span class="op">==</span><span class="st"> &quot;A&quot;</span>) <span class="op">/</span><span class="st"> </span>N <span class="co"># add first generation&#39;s p for run r</span>
    
    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {
      
      p_demonstrator &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,N)
      p_demonstrator[population<span class="op">$</span>status <span class="op">==</span><span class="st"> &quot;low&quot;</span>] &lt;-<span class="st"> </span>p_low
      
      <span class="cf">if</span>(<span class="kw">sum</span>(p_demonstrator) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){
        
        demonstrator_index &lt;-<span class="st"> </span><span class="kw">sample</span> (N, <span class="dt">prob =</span> p_demonstrator, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
        
        population<span class="op">$</span>trait &lt;-<span class="st"> </span>population<span class="op">$</span>trait[demonstrator_index]
      
      }
      output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t <span class="op">&amp;</span><span class="st"> </span>output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>trait <span class="op">==</span><span class="st"> &quot;A&quot;</span>) <span class="op">/</span><span class="st"> </span>N <span class="co"># get p and put it into output slot for this generation t and run r</span>
    }
    
  }
  output <span class="co"># export data from function</span>
}</code></pre></div>
<p>We can now test our simulation, assuming a very low, but not null, probability to select low-status individuals as demonstrators (remember we are using the habitual <code>plot_multiple_runs()</code> function to plot the results of the simulations).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">biased_transmission_demonstrator</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">p_s =</span> <span class="fl">0.05</span>, <span class="dt">p_low=</span><span class="fl">0.0001</span>, <span class="dt">p_0 =</span> <span class="fl">0.5</span>, <span class="dt">t_max =</span> <span class="dv">50</span>, <span class="dt">r_max =</span> <span class="dv">5</span>)
<span class="kw">plot_multiple_runs</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/5.7-1.png" width="672" /></p>
<p>The results are similar to what we saw in the <a href="biased-transmission-indirect-bias-frequency.html#biased-transmission-indirect-bias-frequency">previous chapter</a>) for conformity: one of the two traits quickly reaches fixation. In the case of conformity, however, the trait reaching fixation was the one that happened to have, because of the random initialisation, a slightly higher frequency at the beginning. With a demonstrator bias, this is not the case. The succesfull trait is the one that, irrispectively from its initial frequency, happens to be carried by high-status individuals.</p>
<p>From this perspective, an indirect, demonstrator-based, bias is more similar to unbiased transmission. If you remember from the <a href="unbiased-transmission.html#unbiased-transmission">first chapter</a>, simulations with unbiased transmission also ended up with one trait reaching fixation with small populations (<span class="math inline">\(N=100\)</span>), but with bigger ones (<span class="math inline">\(N=10000\)</span>) the frequencies of the two traits remained around <span class="math inline">\(p=0.5\)</span>. What does it happen with a demonstrator bias?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">biased_transmission_demonstrator</span>(<span class="dt">N =</span> <span class="dv">10000</span>, <span class="dt">p_s =</span> <span class="fl">0.005</span>, <span class="dt">p_low=</span><span class="fl">0.0001</span>, <span class="dt">p_0 =</span> <span class="fl">0.5</span>, <span class="dt">t_max =</span> <span class="dv">200</span>, <span class="dt">r_max =</span> <span class="dv">5</span>)
<span class="kw">plot_multiple_runs</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/5.8-1.png" width="672" /></p>
<p>Even with <span class="math inline">\(N=10000\)</span>, if the number of high-status individuals is sufficiently low, as in this case (<span class="math inline">\(p_s=0.005\)</span> means that, on average, 50 individuals are high-statuts in each run), traits reach fixation. By reducing the pool of demonstrators, demonstrator-based bias makes drift more important for the overall dynamics. You can experiment with different values of <span class="math inline">\(p_s\)</span> and <span class="math inline">\(p_low\)</span>. How big can be the pool of high-stats demonstrators before the dynamics become undistinhishable from unbiased transmission.</p>
</div>
<div id="predicting-the-winning-trait" class="section level2">
<h2><span class="header-section-number">5.2</span> Predicting the winning trait</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biased_transmission_demonstrator_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(N, p_<span class="dv">0</span>, p_s, p_low, t_max, r_max) {
  
  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">status_A =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, r_max), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max)))
  
  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {
    
    population &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trait =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_<span class="dv">0</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">0</span>)),
                     <span class="dt">status =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>), N, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p_s, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_s))) 
    
    output[output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>status_A &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>status <span class="op">==</span><span class="st"> &quot;high&quot;</span> <span class="op">&amp;</span><span class="st"> </span>population<span class="op">$</span>trait <span class="op">==</span><span class="st"> &quot;A&quot;</span>) <span class="op">/</span><span class="st"> </span>
<span class="st">      </span><span class="kw">sum</span>(population<span class="op">$</span>status <span class="op">==</span><span class="st"> &quot;high&quot;</span>)
    
    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max) {
      
      p_demonstrator &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,N)
      p_demonstrator[population<span class="op">$</span>status <span class="op">==</span><span class="st"> &quot;low&quot;</span>] &lt;-<span class="st"> </span>p_low
      
      <span class="cf">if</span>(<span class="kw">sum</span>(p_demonstrator) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){
        
        demonstrator_index &lt;-<span class="st"> </span><span class="kw">sample</span> (N, <span class="dt">prob =</span> p_demonstrator, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
        
        population<span class="op">$</span>trait &lt;-<span class="st"> </span>population<span class="op">$</span>trait[demonstrator_index]
      
      }
    }
  output[output<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(population<span class="op">$</span>trait <span class="op">==</span><span class="st"> &quot;A&quot;</span>) <span class="op">/</span><span class="st"> </span>N     
  }
  output <span class="co"># export data from function</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">biased_transmission_demonstrator_2</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">p_s =</span> <span class="fl">0.05</span>, <span class="dt">p_low=</span><span class="fl">0.0001</span>, <span class="dt">p_0 =</span> <span class="fl">0.5</span>, <span class="dt">t_max =</span> <span class="dv">50</span>, <span class="dt">r_max =</span> <span class="dv">50</span>)</code></pre></div>
<p>In this case, we do not write a function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">filter</span>(data_model, p <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>p <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
data_model[data_model<span class="op">$</span>p<span class="op">==</span><span class="dv">1</span>,]<span class="op">$</span>p &lt;-<span class="st"> &quot;A&quot;</span>
data_model[data_model<span class="op">$</span>p<span class="op">==</span><span class="dv">0</span>,]<span class="op">$</span>p &lt;-<span class="st"> &quot;B&quot;</span>

<span class="kw">ggplot</span>(<span class="dt">data =</span> data_model, <span class="kw">aes</span>( <span class="dt">x =</span> p, <span class="dt">y =</span> status_A)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;proportion of high-status individuals with trait A&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;winning trait&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="_main_files/figure-html/5.11-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">biased_transmission_demonstrator_2</span>(<span class="dt">N =</span> <span class="dv">10000</span>, <span class="dt">p_s =</span> <span class="fl">0.005</span>, <span class="dt">p_low=</span><span class="fl">0.0001</span>, <span class="dt">p_0 =</span> <span class="fl">0.5</span>, <span class="dt">t_max =</span> <span class="dv">200</span>, <span class="dt">r_max =</span> <span class="dv">50</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">filter</span>(data_model, p <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>p <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
data_model[data_model<span class="op">$</span>p<span class="op">==</span><span class="dv">1</span>,]<span class="op">$</span>p &lt;-<span class="st"> &quot;A&quot;</span>
data_model[data_model<span class="op">$</span>p<span class="op">==</span><span class="dv">0</span>,]<span class="op">$</span>p &lt;-<span class="st"> &quot;B&quot;</span>

<span class="kw">ggplot</span>(<span class="dt">data =</span> data_model, <span class="kw">aes</span>( <span class="dt">x =</span> p, <span class="dt">y =</span> status_A)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width=</span><span class="fl">0.05</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;proportion of high-status individuals with trait A&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;winning trait&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="_main_files/figure-html/5.13-1.png" width="672" /></p>
<hr />
</div>
<div id="summary-of-the-model-4" class="section level2">
<h2><span class="header-section-number">5.3</span> Summary of the model</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="biased-transmission-indirect-bias-frequency.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
