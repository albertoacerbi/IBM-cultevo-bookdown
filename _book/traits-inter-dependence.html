<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Traits inter-dependence | Individual-based models of cultural evolution</title>
  <meta name="description" content="A minimal working structure for the book" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Traits inter-dependence | Individual-based models of cultural evolution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A minimal working structure for the book" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Traits inter-dependence | Individual-based models of cultural evolution" />
  
  <meta name="twitter:description" content="A minimal working structure for the book" />
  

<meta name="author" content="Alberto Acerbi" />
<meta name="author" content="Alex Mesoudi" />
<meta name="author" content="Marco Smolla" />


<meta name="date" content="2019-11-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="social-learning-of-social-learning-rules.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Individual-based models of cultural evolution</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Basics</b></span><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#initialising-the-simulation"><i class="fa fa-check"></i><b>0.1</b> Initialising the simulation</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#execute-generation-turn-over-many-times"><i class="fa fa-check"></i><b>0.2</b> Execute generation turn-over many times</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#plotting-the-model-results"><i class="fa fa-check"></i><b>0.3</b> Plotting the model results</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#write-a-function-to-wrap-the-model-code"><i class="fa fa-check"></i><b>0.4</b> Write a function to wrap the model code</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#run-several-independent-simulations-and-plot-their-results"><i class="fa fa-check"></i><b>0.5</b> Run several independent simulations and plot their results</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#varying-initial-conditions"><i class="fa fa-check"></i><b>0.6</b> Varying initial conditions</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#summary-of-the-model"><i class="fa fa-check"></i><b>0.7</b> Summary of the model</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#analytical-appendix"><i class="fa fa-check"></i><b>0.8</b> Analytical appendix</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#further-reading"><i class="fa fa-check"></i><b>0.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html"><i class="fa fa-check"></i><b>1</b> Unbiased and biased mutation</a><ul>
<li class="chapter" data-level="1.1" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#unbiased-mutation"><i class="fa fa-check"></i><b>1.1</b> Unbiased mutation</a></li>
<li class="chapter" data-level="1.2" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#biased-mutation"><i class="fa fa-check"></i><b>1.2</b> Biased mutation</a></li>
<li class="chapter" data-level="1.3" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#summary-of-the-model-1"><i class="fa fa-check"></i><b>1.3</b> Summary of the model</a></li>
<li class="chapter" data-level="1.4" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#analytical-appendix-1"><i class="fa fa-check"></i><b>1.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="1.5" data-path="unbiased-and-biased-mutation.html"><a href="unbiased-and-biased-mutation.html#further-reading-1"><i class="fa fa-check"></i><b>1.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html"><i class="fa fa-check"></i><b>2</b> Biased transmission: direct bias</a><ul>
<li class="chapter" data-level="2.1" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#strentgh-of-selection"><i class="fa fa-check"></i><b>2.1</b> Strentgh of selection</a></li>
<li class="chapter" data-level="2.2" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#summary-of-the-model-2"><i class="fa fa-check"></i><b>2.2</b> Summary of the model</a></li>
<li class="chapter" data-level="2.3" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#analytical-appendix-2"><i class="fa fa-check"></i><b>2.3</b> Analytical appendix</a></li>
<li class="chapter" data-level="2.4" data-path="biased-transmission-direct-bias.html"><a href="biased-transmission-direct-bias.html#further-reading-2"><i class="fa fa-check"></i><b>2.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html"><i class="fa fa-check"></i><b>3</b> Biased transmission: frequency-dependent indirect bias</a><ul>
<li class="chapter" data-level="3.1" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#the-logic-of-conformity"><i class="fa fa-check"></i><b>3.1</b> The logic of conformity</a></li>
<li class="chapter" data-level="3.2" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#testing-conformist-transmission"><i class="fa fa-check"></i><b>3.2</b> Testing conformist transmission</a></li>
<li class="chapter" data-level="3.3" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#summary-of-the-model-3"><i class="fa fa-check"></i><b>3.3</b> Summary of the model</a></li>
<li class="chapter" data-level="3.4" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#analytical-appendix-3"><i class="fa fa-check"></i><b>3.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="3.5" data-path="biased-transmission-frequency-dependent-indirect-bias.html"><a href="biased-transmission-frequency-dependent-indirect-bias.html#further-readings"><i class="fa fa-check"></i><b>3.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html"><i class="fa fa-check"></i><b>4</b> Biased transmission: demonstrator-based indirect bias</a><ul>
<li class="chapter" data-level="4.1" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#a-simple-demonstrator-bias"><i class="fa fa-check"></i><b>4.1</b> A simple demonstrator bias</a></li>
<li class="chapter" data-level="4.2" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#predicting-the-winning-trait"><i class="fa fa-check"></i><b>4.2</b> Predicting the ‘winning’ trait</a></li>
<li class="chapter" data-level="4.3" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#summary-of-the-model-4"><i class="fa fa-check"></i><b>4.3</b> Summary of the model</a></li>
<li class="chapter" data-level="4.4" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#analytical-appendix-4"><i class="fa fa-check"></i><b>4.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="4.5" data-path="biased-transmission-demonstrator-based-indirect-bias.html"><a href="biased-transmission-demonstrator-based-indirect-bias.html#further-readings-1"><i class="fa fa-check"></i><b>4.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html"><i class="fa fa-check"></i><b>5</b> Vertical and horizontal transmission</a><ul>
<li class="chapter" data-level="5.1" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#vertical-cultural-transmission"><i class="fa fa-check"></i><b>5.1</b> Vertical cultural transmission</a></li>
<li class="chapter" data-level="5.2" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#horizontal-cultural-transmission"><i class="fa fa-check"></i><b>5.2</b> Horizontal cultural transmission</a></li>
<li class="chapter" data-level="5.3" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#summary-of-the-model-5"><i class="fa fa-check"></i><b>5.3</b> Summary of the model</a></li>
<li class="chapter" data-level="5.4" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#analytical-appendix-5"><i class="fa fa-check"></i><b>5.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="5.5" data-path="vertical-and-horizontal-transmission.html"><a href="vertical-and-horizontal-transmission.html#further-reading-3"><i class="fa fa-check"></i><b>5.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html"><i class="fa fa-check"></i><b>6</b> Multiple traits models</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#introducing-innovation"><i class="fa fa-check"></i><b>6.1</b> Introducing innovation</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#optimising-the-code"><i class="fa fa-check"></i><b>6.2</b> Optimising the code</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#the-distribution-of-popularity"><i class="fa fa-check"></i><b>6.3</b> The distribution of popularity</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#summary-of-the-model-6"><i class="fa fa-check"></i><b>6.4</b> Summary of the model</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#analytical-appendix-6"><i class="fa fa-check"></i><b>6.5</b> Analytical appendix</a></li>
<li class="chapter" data-level="6.6" data-path="multiple-traits-models.html"><a href="multiple-traits-models.html#further-readings-2"><i class="fa fa-check"></i><b>6.6</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="group-structure.html"><a href="group-structure.html"><i class="fa fa-check"></i><b>7</b> Group structured populations and migration</a></li>
<li class="chapter" data-level="8" data-path="social-network-structure.html"><a href="social-network-structure.html"><i class="fa fa-check"></i><b>8</b> Social network structure</a></li>
<li class="chapter" data-level="9" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html"><i class="fa fa-check"></i><b>9</b> Social learning of social learning rules</a><ul>
<li class="chapter" data-level="9.1" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#openness-and-conservatism"><i class="fa fa-check"></i><b>9.1</b> Openness and conservatism</a></li>
<li class="chapter" data-level="9.2" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#maintaining-open-populations"><i class="fa fa-check"></i><b>9.2</b> Maintaining open populations</a></li>
<li class="chapter" data-level="9.3" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#summary-of-the-model-7"><i class="fa fa-check"></i><b>9.3</b> Summary of the model</a></li>
<li class="chapter" data-level="9.4" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#analytical-appendix-7"><i class="fa fa-check"></i><b>9.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="9.5" data-path="social-learning-of-social-learning-rules.html"><a href="social-learning-of-social-learning-rules.html#further-readings-3"><i class="fa fa-check"></i><b>9.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html"><i class="fa fa-check"></i><b>10</b> Traits inter-dependence</a><ul>
<li class="chapter" data-level="10.1" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#compatible-and-incompatible-traits"><i class="fa fa-check"></i><b>10.1</b> Compatible and incompatible traits</a></li>
<li class="chapter" data-level="10.2" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#many-traits-model"><i class="fa fa-check"></i><b>10.2</b> Many-traits model</a></li>
<li class="chapter" data-level="10.3" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#summary-of-the-model-8"><i class="fa fa-check"></i><b>10.3</b> Summary of the model</a></li>
<li class="chapter" data-level="10.4" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#analytical-appendix-8"><i class="fa fa-check"></i><b>10.4</b> Analytical appendix</a></li>
<li class="chapter" data-level="10.5" data-path="traits-inter-dependence.html"><a href="traits-inter-dependence.html#further-readings-4"><i class="fa fa-check"></i><b>10.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Individual-based models of cultural evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="traits-inter-dependence" class="section level1">
<h1><span class="header-section-number">10</span> Traits inter-dependence</h1>
<p>In real life, the relationship a cultural trait has with other, coexisting, cultural traits, is important to determine its success. Nails will enjoy much cultural success in a world where hammers are present, and less in a world where they are not. Being against abortion in contemporary US is strongly correlated to being religious, which, in turn, is (less strongly) correlated with not supporting same-sex marriage. Of course, not all these relationships are stable in time, and they can also be themselves subject to cultural change. In this chapter, we will explore how simple relationships between traits can be modeled, and how they can influence cultural evolution.</p>
<div id="compatible-and-incompatible-traits" class="section level2">
<h2><span class="header-section-number">10.1</span> Compatible and incompatible traits</h2>
<p>We can start by assuming that, when an observer meets a demonstrator, the observer evaluates the relationships of the traits of the demonstrator with its own traits, and use this information to decide whether to copy or not. For example, if the observer has the trait “being religious” and the demonstrator the trait “being pro abortion”, copying will be less likely to happen than if the demonstrator has the trait “being against abortion”.</p>
<p>We can imagine a simple scenario when there are only two possible relationships between two traits: they are compatible, meaning that the presence of one trait will reinforce the presence of the other, or incompatible, meaning the opposite. In addition, the relationship is symmetric: if trait A favours B, also trait B favours A, and the same holds for incompatibility. Finally, we assume that each trait is compatible with itself, simply meaning that, if the observer has trait A and the demonstrator has trait A too, this will increase the probability that copy will happens.</p>
<p>We can represent the relationships between traits, in a simple “world” with only four traits, with a symmetric matrix, as the one below, where <span class="math inline">\(+1\)</span> denotes compatibility, and <span class="math inline">\(-1\)</span> denotes incompatibility.</p>
<table>
<thead>
<tr class="header">
<th>Traits</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>A</strong></td>
<td align="right">+1</td>
<td align="right">+1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td><strong>B</strong></td>
<td align="right">+1</td>
<td align="right">+1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td><strong>C</strong></td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">+1</td>
<td align="right">+1</td>
</tr>
<tr class="even">
<td><strong>D</strong></td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">+1</td>
<td align="right">+1</td>
</tr>
</tbody>
</table>
<p>In this case, the traits A and B are compatible with themselves, but incompatible with C and D, and the same happens for C and D, that are compatible with themselves, but incompatible with A and B.</p>
<p>We can build manually the same matrix in R, by indicating one-by-one the values we want to fill in, and the number of rows and columns the matrix needs to have. As usual, we can check that we did right asking to print the matrix, by writing its name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">set.seed</span>(<span class="dv">111</span>)
my_world &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
my_world</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    1   -1   -1
## [2,]    1    1   -1   -1
## [3,]   -1   -1    1    1
## [4,]   -1   -1    1    1</code></pre>
<p>Given this simple way of representing a “world” of compatibilities among traits, we can write our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">traits_inter_dependence &lt;-<span class="st"> </span><span class="cf">function</span>(N, t_max, k, mu, p_death, world){
  output &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">trait =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>), <span class="dt">each =</span> t_max), <span class="dt">generation =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>t_max, <span class="dv">4</span>), <span class="dt">p =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, t_max <span class="op">*</span><span class="st"> </span><span class="dv">4</span>))      
  population &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">nrow =</span> N)
  output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span><span class="dv">1</span> ,]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">colSums</span>(population) <span class="op">/</span><span class="st"> </span>N
  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max){
    <span class="co"># innovations</span>
    innovators &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), N, <span class="dt">prob =</span> <span class="kw">c</span>(mu, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu), <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
    innovations &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">sum</span>(innovators), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    population[<span class="kw">cbind</span>(<span class="kw">which</span>(innovators <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>), innovations)] &lt;-<span class="st"> </span><span class="dv">1</span>
    
    <span class="co"># copying</span>
    demonstrators &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    demonstrators_traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    
    <span class="co"># not sure how to vectorise the code below. The first &quot;if&quot; can be done with:</span>
    <span class="co"># population[cbind(demonstrators,demonstrators_traits)]==1 as in previous chapter</span>
    <span class="co"># but I could not figure out a way to calcualte the compatibility score at popualtion level</span>
    
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
      <span class="cf">if</span>(population[demonstrators[i], demonstrators_traits[i]]){
        compatibility_score &lt;-<span class="st"> </span><span class="kw">sum</span>(world[demonstrators_traits[i], <span class="kw">which</span>(population[i,]<span class="op">&gt;</span><span class="dv">0</span>)])
        copy &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>compatibility_score))) <span class="op">&gt;</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
        <span class="cf">if</span>(copy){
          population[i,demonstrators_traits[i]] &lt;-<span class="st"> </span><span class="dv">1</span>
        }
      }
    }
    
    <span class="co"># birth/death</span>
    replace &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), N, <span class="dt">prob =</span> <span class="kw">c</span>(p_death, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_death), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    population[replace, ] &lt;-<span class="st"> </span><span class="dv">0</span>
    
    output[output<span class="op">$</span>generation <span class="op">==</span><span class="st"> </span>t ,]<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">colSums</span>(population) <span class="op">/</span><span class="st"> </span>N
  }
  output
}</code></pre></div>
<p>As in the <a href="social-learning-of-social-learning-rules.html#social-learning-of-social-learning-rules">previous chapter</a>, the simulation starts with no traits, and individuals introduce them with random innovations, the rate of which is regulated by the parameter <span class="math inline">\(\mu\)</span>. Individuals are replaced by culturally-naive newborns with a probability <span class="math inline">\(p_\text{death}\)</span>. There are, mainly, two differences. One is that the function accepts a parameter, <code>world</code>, a four-by-four matrix of compatibilities between traits (thus the compatibilities can change, but not the actual number of traits). The second is in the copying procedure.</p>
<p>As in the previous chapter, one trait is randomly selected in the demonstrator and, if the demonstrator <em>i</em> has it (<code>population[demonstrators[i], demonstrators_traits[i]]</code>), the observer calculates a “compatibility score”. The compatibility score is the sum of the compatibilities of all the traits of the observer towards the traits of the demonstrator, calculated using the “world” matrix. If, for example, both observer and demonstrator have A and B (and only A and B), the compatibility with be <span class="math inline">\(2\)</span>, if the observer has A and B and the demonstrator C and D, the compatibility with be <span class="math inline">\(-2\)</span> and so on. In the following line, the compatibility score is transformed in the actual probability to copy with a logistic function, useful to transform possibly unbounded positive and negative values in values between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>:</p>
<p><span class="math display">\[P_\text{copy} = \frac{1}{1 + e^{-kC}}         \hspace{30 mm}(15.1)\]</span> where <em>C</em> represents the compatibility score between observer and demonstrator, and <em>k</em> is a parameter of the simulation, that regulates how steep is the logistic, that is, how fast positive values of the compatibility score produce a probability to copy equal to <span class="math inline">\(1\)</span>, and negative values a probability equal to <span class="math inline">\(0\)</span>.</p>
<p>We can now run the function, using the <code>plot_multiple_traits()</code> function to plot the result. We use a value of <span class="math inline">\(k=10\)</span>, and a small probability of innovation <span class="math inline">\(\mu=0.0005\)</span>, so that the dynamics are mainly generated by cultural transmission.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_world &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">t_max =</span> <span class="dv">1000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.0005</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">world =</span> my_world)
<span class="kw">plot_multiple_traits</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/15.4-1.png" width="672" /></p>
<p>Two of the four traits diffuse in the population. We can check whether these are in fact one of the couple of compatible traits, having a look at the last line of the output produced by the simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model[data_model<span class="op">$</span>generation<span class="op">==</span><span class="dv">1000</span>,]</code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   trait generation     p
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt;
## 1 A           1000  0.04
## 2 B           1000  0.03
## 3 C           1000  0.91
## 4 D           1000  0.92</code></pre>
<p>They are indeed trait C and D. If you run the simulation other times the results are likely to change, with sometime A and B being the successful traits, but it will be practically impossible that one or three traits will be successful, with this “world” of compatibilities.</p>
<p>What does it happen, however, if we change the world? We can run a new simulation where the traits A, B, and C are all compatible, but not D (remember, you can visualise the matrix of compatibilities by typing its name to be sure to have entered the compatibilities correctly).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_world &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">t_max =</span> <span class="dv">1000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.0005</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">world =</span> my_world)
<span class="kw">plot_multiple_traits</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/15.6-1.png" width="672" /></p>
<p>As expected, now three traits have high frequencies in the population, while one is unsuccessful. As before, you can check that the unsuccessful trait is actually D by inspecting manually the last line of the output.</p>
<p>Not surprisingly, if all traits are compatible, they all spread equally in the population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_world &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)
data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">t_max =</span> <span class="dv">1000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.0005</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">world =</span> my_world)
<span class="kw">plot_multiple_traits</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/15.7-1.png" width="672" /></p>
<p>Notice that the opposite—when none of the traits is compatible with each other—is an extreme case that produces a situation similar to the <a href="multiple-traits-models.html#multiple-traits-models">unbiased transmission model with multiple traits</a> we explored earlier in the book. Individuals only copy once in their life, when they do not have any trait, and they copy whatever trait they observe with 50% probability, since a compatibility score of <span class="math inline">\(0\)</span> while always produce <span class="math inline">\(0.5\)</span> when transformed by the logistic function. After that, any encounter will produce a very low probability of copying (when they meet demonstrators with any other trait), or a high, but useless, probability (when they meet a demonstrator with the same trait they already have).</p>
</div>
<div id="many-traits-model" class="section level2">
<h2><span class="header-section-number">10.2</span> Many-traits model</h2>
<p>Building the compatibility world by hand is unpractical, especially if we want to test our model with more traits. We will now extend the basic model above in order to be able to customise the maximum number of traits and to generate automatically the compatibility worlds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M &lt;-<span class="st"> </span><span class="dv">7</span>
gamma &lt;-<span class="st"> </span><span class="fl">0.5</span>
my_world &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">rep</span>(<span class="dv">1</span>, M <span class="op">*</span><span class="st"> </span>M), <span class="dt">nrow =</span> M)
compatibilities &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), <span class="kw">choose</span>(M, <span class="dv">2</span>), <span class="dt">prob =</span> <span class="kw">c</span>(gamma, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>gamma), <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
my_world[<span class="kw">upper.tri</span>(my_world)] &lt;-<span class="st"> </span>compatibilities
my_world &lt;-<span class="st"> </span><span class="kw">t</span>(my_world)
my_world[<span class="kw">upper.tri</span>(my_world)] &lt;-<span class="st"> </span>compatibilities</code></pre></div>
<p>We have now two parameters we use to build the matrix: one (<span class="math inline">\(M\)</span>) gives the maximum number of traits, and the other (<span class="math inline">\(\gamma\)</span>, or <code>gamma</code> in the code) gives the probability that two traits are compatible with each other. To build the matrix, we first create a <span class="math inline">\(M\)</span> by <span class="math inline">\(M\)</span> matrix of all ones, then a vector of compatibilities randomly generated with probability <span class="math inline">\(\gamma\)</span> (the length of the vector is the number of entries above the main diagonal of the matrix, given by <code>choose(M, 2)</code>), and finally we copy these values in the upper and lower triangle of the matrix (to make it symmetric, in practice, we copy it twice in the upper triangle, transposing the matrix after the first copy).</p>
<p>Here the matrix we generated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_world</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1   -1   -1   -1   -1    1   -1
## [2,]   -1    1    1    1    1    1   -1
## [3,]   -1    1    1   -1    1   -1   -1
## [4,]   -1    1   -1    1    1   -1    1
## [5,]   -1    1    1    1    1   -1    1
## [6,]    1    1   -1   -1   -1    1    1
## [7,]   -1   -1   -1    1    1    1    1</code></pre>
<p>The function to run the simulation is very similar to the previous one, once we account for the difference in how the compatibility world is created, and the two new parameters (<span class="math inline">\(M\)</span> and <span class="math inline">\(\gamma\)</span>) needed in the function call. Another difference is that the output data structure is a matrix and not a tibble. Since we want to be able to run the simulations with an arbitrary high number of traits, we need to speed up the computation, exactly in the same way we did for the multiple traits model in <a href="multiple-traits-models.html#multiple-traits-models">chapter 7</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">traits_inter_dependence_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(N, M, t_max, k, mu, p_death, gamma){
  output &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> t_max, <span class="dt">ncol =</span> M)
  <span class="co"># initalise the traits&#39; world:</span>
  world &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">rep</span>(<span class="dv">1</span>, M <span class="op">*</span><span class="st"> </span>M), <span class="dt">nrow =</span> M)
  compatibilities &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), <span class="kw">choose</span>(M,<span class="dv">2</span>), <span class="dt">prob =</span> <span class="kw">c</span>(gamma, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>gamma), <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
  world[<span class="kw">upper.tri</span>(world)] &lt;-<span class="st"> </span>compatibilities
  world &lt;-<span class="st"> </span><span class="kw">t</span>(world)
  world[<span class="kw">upper.tri</span>(world)] &lt;-<span class="st"> </span>compatibilities
  <span class="co"># initialise the population:</span>
  population &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> M, <span class="dt">nrow =</span> N)
  output[<span class="dv">1</span>, ] &lt;-<span class="st"> </span><span class="kw">colSums</span>(population) <span class="op">/</span><span class="st"> </span>N 
  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>t_max){
    <span class="co"># innovations</span>
    innovators &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), N, <span class="dt">prob =</span> <span class="kw">c</span>(mu, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu), <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
    innovations &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>M, <span class="kw">sum</span>(innovators), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    population[<span class="kw">cbind</span>(<span class="kw">which</span>(innovators <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>), innovations)] &lt;-<span class="st"> </span><span class="dv">1</span>
    
    <span class="co"># copying</span>
    demonstrators &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    demonstrators_traits &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>M, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)

    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
      <span class="cf">if</span>(population[demonstrators[i], demonstrators_traits[i]]){
        compatibility_score &lt;-<span class="st"> </span><span class="kw">sum</span>(world[demonstrators_traits[i], <span class="kw">which</span>(population[i,]<span class="op">&gt;</span><span class="dv">0</span>)])
        copy &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>compatibility_score))) <span class="op">&gt;</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
        <span class="cf">if</span>(copy){
          population[i,demonstrators_traits[i]] &lt;-<span class="st"> </span><span class="dv">1</span>
        }
      }
    }
    
    <span class="co"># birth/death</span>
    replace &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), N, <span class="dt">prob =</span> <span class="kw">c</span>(p_death, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_death), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    population[replace, ] &lt;-<span class="st"> </span><span class="dv">0</span>
    
    output[t, ] &lt;-<span class="st"> </span><span class="kw">colSums</span>(population) <span class="op">/</span><span class="st"> </span>N
  }
  output
}  </code></pre></div>
<p>We can now use the <code>plot_multiple_traits_matrix()</code> function we wrote in <a href="multiple-traits-models.html#multiple-traits-models">chapter 7</a> to visualise the results of the model. We can have a look at what happens with 20 traits, and an intermediate probability of compatibility.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence_2</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">M =</span> <span class="dv">20</span>, <span class="dt">t_max =</span> <span class="dv">2000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.001</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">gamma =</span> .<span class="dv">5</span>)
<span class="kw">plot_multiple_traits_matrix</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/15.12-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence_2</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">M =</span> <span class="dv">20</span>, <span class="dt">t_max =</span> <span class="dv">2000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.001</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">gamma =</span> <span class="dv">1</span>)
<span class="kw">plot_multiple_traits_matrix</span>(data_model)</code></pre></div>
<p><img src="_main_files/figure-html/15.13-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_max =<span class="st"> </span><span class="dv">10</span>
test_inter_dependence &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">gamma =</span> <span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">1</span>), r_max), <span class="dt">run =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>r_max, <span class="dt">each =</span> <span class="dv">11</span>)), <span class="dt">C =</span> <span class="ot">NA</span>)
<span class="cf">for</span>(condition <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">1</span>)){
  <span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r_max) {
    data_model &lt;-<span class="st"> </span><span class="kw">traits_inter_dependence_2</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">M =</span> <span class="dv">20</span>, <span class="dt">t_max =</span> <span class="dv">2000</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="fl">0.001</span>, <span class="dt">p_death =</span> <span class="fl">0.01</span>, <span class="dt">gamma =</span> condition)
    test_inter_dependence[test_inter_dependence<span class="op">$</span>gamma <span class="op">==</span><span class="st"> </span>condition <span class="op">&amp;</span><span class="st"> </span>test_inter_dependence<span class="op">$</span>run <span class="op">==</span><span class="st"> </span>r, ]<span class="op">$</span>C &lt;-<span class="st"> </span><span class="kw">sum</span>(data_model[<span class="dv">2000</span>,]<span class="op">&gt;</span>.<span class="dv">5</span>)
  }
}
<span class="kw">ggplot</span>(<span class="dt">data =</span> test_inter_dependence, <span class="kw">aes</span>(<span class="dt">x =</span> gamma, <span class="dt">y =</span> C)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="dv">0</span>, <span class="dt">height =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average compatibility&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;C (number of common traits)&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/15.14-1.png" width="672" /></p>
</div>
<div id="summary-of-the-model-8" class="section level2">
<h2><span class="header-section-number">10.3</span> Summary of the model</h2>
<p>Mention the logistic, and the last visualisation</p>
<hr />
</div>
<div id="analytical-appendix-8" class="section level2">
<h2><span class="header-section-number">10.4</span> Analytical appendix</h2>
<hr />
</div>
<div id="further-readings-4" class="section level2">
<h2><span class="header-section-number">10.5</span> Further readings</h2>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="social-learning-of-social-learning-rules.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
