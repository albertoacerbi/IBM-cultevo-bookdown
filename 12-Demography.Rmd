
# Demography

Important aspect of cumulative cultural evolution: demography

How can we explain the growth in culture in many human societies and the decline in some others?

Henrich 2004 (@henrich_demography_2004) suggests that demography affects cumulative cultural evolution

Presents an analytical model to explain how societies below a critical size (of cultural learners) might lose complex (or even simple) cultural traits over time

The idea is this: fundamental in cultural evolution is the transmission of information from one generation to another. Imagine a group of students who try to acquire the skills to manufacture a spear. As imitation is imperfect, and memorising and recalling action sequences is error-prone some students will end up with a spear that is inferior to the one of their cultural model. A few individuals might achieve a similar or even higher skill level than their model. These individuals will now become the new cultural models. How does this play out over time? 

Assumption (needs graph with density)


```{r}
beta <- 1
alpha <- beta*7
alpha/beta

Rounds <- 100
N <- 5000
f <- rep(NA, N)
z <- runif(n=N, min=0, max=1)
zbar <- rep(NA, Rounds)

for(r in 1:Rounds){
  # update f
    # f <- z/max(z)
    # or for perfect identification of most skilful individual
    f <- as.numeric(z == max(z))
  
  # choose whom to observe
    obs <- sample(x=1:N, prob=f, replace=T)
    
  # calculate new z
  znew <- rlogis(n=N, location=z[obs]-alpha, scale=beta)
  
  # record average z
    zbar[r] <- mean(znew-z)
      
  # update z
    z <- znew
}
plot(zbar, type="l", xlab="time", ylab="change in z")
mean(zbar)
```

```{r}
# automate process
demography_model <- function(R, N, f, z, alpha, beta, repeats){
  res <- lapply(1:repeats, function(r){
    z <- runif(n=N, min=0, max=1)
    zbar <- rep(NA, R)
    for(r in 1:R){
      # we simplify and ommit f and obs by assuming all individuals observe the best individual 
      znew <- rlogis(n=N, location=z[ which.max(z) ]-alpha, scale=beta)
      # alternatively, use rgumbel function from the extraDistr package
      # library(extraDistr)
      # znew <- rgumbel(n=N, mu=z[ which.max(z) ]-alpha, sigma=beta)
      
      zbar[r] <- mean(znew-z)
      z <- znew
    }
    return(mean(zbar))
  })
  mean(unlist(res))
}

demography_model(R=100, N=5000, alpha=7, beta=1, repeats=10)

sizes <- c(2, seq(100,5000,by=100))
res <- lapply(sizes, demography_model, R=200, alpha=7, beta=1, repeats=20)
res2 <- lapply(sizes, demography_model, R=200, alpha=9, beta=1, repeats=20)
df <- data.frame(N = sizes, zbar = c(unlist(res), unlist(res2)), skill=rep(c("simple","complex"), each=length(sizes)))

library(ggplot2)
ggplot(df) + geom_line(aes(x=N, y=zbar, color=skill)) + xlab("N") + ylab("z bar") + geom_hline(yintercept=0)
# results don't match exactly, but we are using logistic distribution here and not gumble

```

```{r}
data <- data.frame(skill = rep(c("simple","complex"), each=6000),
                   z = c(rlogis(n=6000, location=-7, scale=1),
                         rlogis(n=6000, location=-9, scale=1)))
# data <- data.frame(skill = rep(c("simple","complex"), each=6000),
#                    z = c(rgumbel(n=6000, mu=-7, sigma=1),
#                          rgumbel(n=6000, mu=-9, sigma=1)))
ggplot(data, aes(x=z, col=skill)) +
  geom_density() + 
  geom_vline(xintercept=0) #+ scale_x_continuous(limits=c(-20, 5))

# with these values of alpha/beta I cannot find the same results as shown in Henrich's paper, however, with beta=2 the results look more like it but then a/b would be 3.5 and 4.5
```





## Summary of the model


***

## Analytical appendix

Henrich's actual paper is analytical

***

## Further readings


***

## References

